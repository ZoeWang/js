litb.langs = {
    "reviewerImage": {
        "title": "Reviewer Images",
        "direct": "(click to see full-size image)"
    },
    "pageText": "Displaying",
    "pageBar": {
        "page": "page",
        "prev": "Previous",
        "next": "Next",
        "of": "of"
    },
    "backToTop": "Back to top",
    "pleaseSelect": "Please Select",
    "pleaseSelectAttr": "Please complete your selection(s) before adding to cart.",
    "selectItem": "Select this item",
    "removeItem": "Remove this item",
    "recommendations": "RECOMMENDATIONS",
    "othersBuyItems": "What Do Customers Ultimately Buy After Viewing This Item?",
    "customerSay": "\"http:\/\/www.lightinthebox.com\/index.php?main_page=testimonials\" class=\"more_product\" title=\"More Customer Testimonials\">",
    "moreCustomer": "More Customer Testimonials &gt;&gt;",
    "reviewFieldRequired": "Sorry, {0} is required.",
    "reviewEmailInvalid": "Are you sure your {0} is correct? E-mail addresses must contain an \"at\" sign (@) and a period (.) somewhere to the right of the @, with no spaces or commas. (Example: yourname@hotmail.com)",
    "reviewLengthExceeded": "Is your {0} correct? Our system requires a maximum of {1} characters.",
    "reviewTermNotAgreed": "You must agree to our Terms of conditions",
    "star": "<b>{0}<\/b> Star",
    "stars": "<b>{0}<\/b> Stars",
    "datepicker_opt": {
        "closeText": "Close",
        "prevText": "Prev",
        "nextText": "Next",
        "currentText": "Today",
        "monthNames": ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
        "monthNamesShort": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
        "dayNames": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
        "dayNamesShort": ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
        "dayNamesMin": ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
        "weekHeader": "Wk",
        "dateFormat": "dd-mm-yyyy",
        "firstDay": "1",
        "isRTL": "false",
        "showMonthAfterYear": "false",
        "yearSuffix": " "
    },
    "uploadify_opt": {
        "buttonText": "Upload photo(s)",
        "fileSizeNote": "Note: Individual photo size cannot exceed {0}MB.",
        "fileSizeNotice": "Individual photo size cannot exceed {0}MB.",
        "fileLimitNotice": "Number of photos cannot exceed {0}"
    },
    "countDowntDay": "DAY",
    "countDowntDayS": "DAYS",
    "ckReg": {
        "noEmailAddress": "Please enter an email address.",
        "invalidEmailAddress": "Please check your email format.",
        "existEmailAddress": "An account already exists for this email address.",
        "signinInvalidEmail": "The email you've entered is invalid. Please check your email and try again.",
        "noPassword": "Please enter your password.",
        "invalidPassword": "Your password must contain a minimum of {0} characters.",
        "noConfirmPassword": "Please re-enter your password.",
        "passwordNotMatch": "Your passwords do not match, please try again.",
        "noCountry": "Please select your default shipping country.",
        "notAgreeTerms": "Please make sure you agree to our Terms and Conditions.",
        "noConfirmEmailAddress": "Please confirm your email address.",
        "emailAddressesNotMatch": "The email addresses entered do not match.",
        "noUserName": "Please enter an user name",
        "invalidUserName": "The user name is invalid",
        "existedUserName": "The user name has been used",
        "existUserNameAddress": "",
        "wrongPassword": "The password you entered is incorrect."
    },
    "and": "and",
    "poAddr": {
        "noFirstName": "Please enter your first name.",
        "exceedFullName": "Your full name cannot exceed 34 characters",
        "noLastName": "Please enter your last name.",
        "noShippingAddress": "Please enter shipping address.",
        "shortShippingAddress": "Your shipping address should be at least {0} characters long.",
        "noCity": "Please enter your city.",
        "shortCity": "Your city should be at least {0} characters long.",
        "noCountry": "Please select your destination country.",
        "noPostcode": "Please enter a ZIP \/ postal code.",
        "shortPostcode": "Your ZIP \/ postal code should be at least {0} digits long.",
        "noPhone": "Please enter your phone number.",
        "shortPhone": "Your phone number must be at least {0} digits.",
        "invalidPhone": "Please enter a valid phone number.",
        "noPersonalTaxCode": "Sorry, your CPF is required.",
        "invalidPersonalTaxCode": "Your CPF must contain a minimum of {0} numbers.",
        "invalidCompanyTaxCode": "Your CNPJ must contain a minimum of {0} numbers.",
        "noCompanyTaxCode": "Sorry, your CNPJ is required.",
        "edit": "Edit",
        "areaPhoneExceed": "Your phone number and country code cannot exceed {0} characters.",
        "noZoneId": "Please select your state\/province\/region.",
        "shortFirstName": "Your First name must contain a minimum of {0} characters.",
        "shortLastName": "Your Last name must contain a minimum of {0} characters.",
        "atLeastOnePhone": ""
    },
    "subscribe_text": "Please check your email address.Your email addresses should look like \"myname@gmail.com\"",
    "apply": "Apply",
    "processing": "processing",
    "validate": "Validate",
    "YourEmailAddress": "E-mail adress",
    "more": "more",
    "less": "less",
    "viewAll": "View All",
    "viewLess": "Hide",
    "orderSubmit": {
        "incompleteAddress": "Please save your shipping address first.",
        "noPaymentMethod": "Please select your payment method.",
        "incompleteBillingAddress": "Please save your billing address first.",
        "noAvailAddress": "Please enter your shipping address or choose one from your previously entered addresses."
    },
    "manageAddr": {
        "delConfirm": "Are you sure want to delete this shipping address?"
    },
    "networkError": "Sorry, we encountered a network problem, please try again.",
    "starRating": ["Poor", "Fair", "Average", "Good", "Excellent"],
    "ticket": {
        "detailMsgExceeds": "Is your Your detailed message correct? Our system requires a maximum of {0} characters.",
        "noDetailMsg": "Your detailed message is required.",
        "noName": "Your Name is required.",
        "noCountry": "Please choose \"Country \/ Region\""
    },
    "chosen": {
        "noResultsMatch": "No results match \"<span><\/span>\""
    },
    "reviewSubmitErrs": "Please check above for the red error message and fill in the necessary section.",
    "outOfStock": "Out of Stock",
    "address": {
        "shippingAddress": "Shipping Address",
        "billingAddress": "Billing Address",
        "shippingAddressContinued": "Shipping Address Continued",
        "billingAddressContinued": "Billing Address Continued"
    },
    "submit": "submit",
    "account": {
        "noExistPassword": "Please enter your existing password.",
        "noNewPassword": "Please enter a new password.",
        "reEnterNewPassword": "Please re-enter your new password.",
        "noNewEmail": "Please enter a new e-mail address."
    },
    "addToCart": "Add to Cart",
    "loading": "Loading...",
    "networkErrorRetry": "Sorry, we encountered a network problem, please <a href=\"javascript:void(0)\" class=\"retry\">try again<\/a>.",
    "cartItem": "Cart {0} item",
    "cartItems": "Cart {0} items",
    "selectReason": "Please select a reason",
    "upload": {
        "jpg": "Please only provide JPG files.",
        "server": "Sorry, your photo(s) didn't upload properly, please try again.",
        "size": "Individual photo size cannot exceed 2MB.",
        "format": "Please only provide JPG files."
    },
    "free": "Free",
    "continue": "Continue",
    "wiretrs": {
        "noSenderName": "Sorry, Sender's Name is required.",
        "shortSenderName": "Your Sender's Name must contain a minimum of {0} characters.",
        "noCountry": "\u300cCountry\u300d Please choose "
    },
    "westuni": {
        "noControlNo": "Sorry, Money Transfer Control No. is required.",
        "shortControlNo": "Your Money Transfer Control No. must be {0} digits.",
        "shortMiddleName": "Your Middle Name must contain a minimum of {0} characters.",
        "noAddress": "Sorry, Sender's Address is required.",
        "shortAddress": "Your Sender's Address must contain a minimum of {0} characters.",
        "noCountry": "Please choose \"Country \/ Region\""
    },
    "fastDelivery_text": "<strong>Ordering for Christmas?<\/strong> Your selection is not an <em class=\"iconXmas\"><\/em> item and requires normal processing time.<a class=\"b u color333\" href=\"http:\/\/www.lightinthebox.com\/html\/Christmas_Shipping_Guide.html\" target=\"_blank\">See the Shipping Guide for Christmas ordering cutoff dates<\/a>.\n",
    "pleaseSelectAttrToAddFav": "Please complete your selection(s) before adding to Favorite",
    "orderCancerConfirm": "Are you sure you want to delete this order?",
    "discountCountDown": {
        "off": "Off",
        "days": "days",
        "left": "remaining",
        "day": "day"
    },
    "freeShipping": "<b>Free<\/b> Shipping",
    "affPay": {
        "noPaypalAccount": "Enter PayPal account",
        "invalidPaypalAccount": "PayPal account is invalid.",
        "notMatchPaypalAccount": "Confirm your PayPal account.",
        "noConfirmPaypalAccount": "Confirm PayPal account",
        "noPassword": "Enter your {0} account password.",
        "incorrectPassword": "Password is incorrect.",
        "removePaypalConfirm": "Are you sure you want to remove this PayPal account?",
        "paypalAdded": "You have successfully added your PayPal account.",
        "paypalModified": "You have successfully modified your PayPal account."
    },
    "remaining": "remaining",
    "remainings": "remaining",
    "remove": "remove",
    "yes": "Yes",
    "_no": "No",
    "buy": "buy",
    "opusInvalidCard": "Card number is invalid.",
    "opusDate": "Please enter expiration date.",
    "opusNoCode": "Please enter security code.",
    "opusDateExpired": "Expiration date is invalid.",
    "opusChooseCard": "Please choose credit card.",
    "opusNoCard": "Please enter card number.",
    "opusInvalidCode": "Security code is invalid",
    "noResultMatch": "No result match",
    "selecteMailType": "Please select email type",
    "bought": "bought",
    "time": "time",
    "door": "",
    "countdown": {
        "day": "day",
        "days": "days"
    },
    "qiwiNoNumber": "Please enter a valid account number.",
    "qiwiInvalidNumber": "Sorry, you have entered an invalid account number. Please check and try again.",
    "emptyNavCart": "Your shopping cart is empty.",
    "btnConfirm": "Confirm and Submit",
    "placeYourOrder": "Place Your Order",
    "proceedToPayPal": "Proceed to PayPal",
    "continueText": "Continue",
    "litbg": {
        "slogan": "Win a Coupon worth up to",
        "prac": "Practice ",
        "signin": "Sign In and\n",
        "playToWin": "Play to Win a Coupon\n",
        "tip": "Click to hit the boxes and\n earn points\n",
        "start": "Start\n",
        "main": "Main Menu",
        "yourPts": "Your Points\n",
        "tryAg": "Try\u00a0Again\n",
        "min": "Minimize Game\n",
        "con": "Congratulations",
        "couponCode": "Coupon Code",
        "minAmount": "Minimum Order Amount\n",
        "expires": "Expires\n",
        "check": "Check my coupon\n",
        "points": "Points",
        "rules": "Play this game to get coupons. You can practice as many times as you want, but you can only play for coupons once each day.\n",
        "ptsRules": "You must sign in to your account to play for coupons. Different boxes give you different points.",
        "win": "You've won a",
        "coupon": "coupon",
        "ptsEg": "0-300 points: USD $1 coupon. 310-400 points: USD $2 coupon. 410-600 points: USD $3 coupon",
        "gb": "Great Job!!!",
        "ready": "Ready To Play To Win?",
        "play": "Play",
        "share": "Share the link for free coupons!"
    },
    "addToMyFav": "Add to My Favorites",
    "myFav": "My Favorites",
    "TeadyToWearLink": "Ready-To-Wear",
    "TeadyToWearTitle": "Can't Wait for Made-To-Order?",
    "TeadyToWearInfo": "These sizes and colors have Ready-To-Wear options and are currently in stock. We will ship it out within 24 hours after you make a purchase. There is no delay for tailoring.\n",
    "TeadyToWearShow": "Show Me Ready-To-Wear Choices\n",
    "ReadyToWearNoteB": "This item also has ready-to-wear options, if you can\u2019t wait for made-to-order. Please check",
    "ReadyToWearJump": "size and color details",
    "ReadyToWearNoteA": ""
};
litb.browser = function() {
    var ver = 100,
    msie = false,
    ie = (function() {
        var undef, v = 3,
        div = document.createElement('div'),
        all = div.getElementsByTagName('i');
        while (div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->', all[0]);
        return v > 4 ? v: undef
    } ());
    if (ie) {
        ver = ie;
        msie = true
    }
    return {
        'msie': msie,
        'version': ie
    }
};
$.browser = litb.browser() || $.browser;
if (!document.addEventListener && document.attachEvent) {
    if (document.documentElement.doScroll && window == window.top)(function() {
        if (jQuery.isReady) return;
        try {
            document.documentElement.doScroll("left")
        } catch(error) {
            setTimeout(arguments.callee, 0);
            return
        };
        jQuery.ready()
    })()
};
$.fn.ie6bgiframe = function(s) {
    if ($.fn.bgiframe) return this.bgiframe(s);
    return this
};
function randomID() {
    var cr = [];
    while (cr.length < 4) cr[cr.length] = String.fromCharCode(Math.floor(Math.random() * 26) + 97);
    return cr.join('') + new Date().getTime()
}
function setHash(newHash) {
    window.location.hash = 'hashNotExist';
    window.location.hash = newHash
};
function tracking(options) {
    var me = this,
    url = "";
    this.sets = {
        lc: litb["lan"],
        mp: litb["mainPage"]
    };
    if (options) {
        $.extend(me.sets, litb["ctr"], options)
    };
    this.u = function() {
        for (var i in me.sets) {
            if (typeof(i) == "string") {
                if (i != "post") url += i + "=" + me.sets[i] + "&"
            }
        }
        var _cust = $.cookie("__cust") != "" ? $.cookie("__cust") : null;
        url += "__cust=" + _cust;
        return url
    };
    this.i = function() {
        var _img = new Image();
        _img.onload = function() {
            _img.onload = null
        };
        _img.src = litb.ctrPath + '?' + me.u() + '&rk=' + Math.floor(Math.random() * 100000000 + 1)
    };
    me.i()
};
function trackingChat() {
    var img = new Image();
    img.src = location.protocol + '//www.lightinthebox.com/click_to_live_chat/?url=' + location.href
};
function trackingClickDom(obj, options) {
    var $me = obj,
    options = options || {};
    var meCtrInfo = eval('[' + $me.attr('ctr') + ']');
    var trackingObj = {
        'entity': $me.attr('entity'),
        'action': 'CLICK'
    };
    var ctrElement = $me.parents('.ctrInfo').eq(0);
    var ctrElementInfo = [];
    if (ctrElement.size() === 1) {
        ctrElementInfo = eval('[' + (ctrElement).attr('ctr') + ']')
    }
    trackingObj = $.extend(trackingObj, ctrElementInfo[0], meCtrInfo[0], options);
    tracking(trackingObj)
}
function trackingShowDom(obj, options) {
    var options = options || {};
    var ctr = eval('[' + obj.attr('ctr') + ']');
    var pids = {};
    if (obj.attr('ctrPids')) pids['pids'] = obj.attr('ctrPids');
    tracking($.extend({
        'action': 'SHOW'
    },
    ctr[0], pids, options))
};
function bindCtr(obj) {
    $('.ctrTrackA a', obj).unbind('mousedown').bind('mousedown',
    function() {
        if (!$(this).hasClass('ctrTrack') && !$(this).hasClass('noCtrTrack')) trackingClickDom($(this))
    });
    $('.ctrTrack', obj).unbind('mousedown').bind('mousedown',
    function() {
        trackingClickDom($(this))
    });
    $('.ctrTrackShow', obj).each(function() {
        trackingShowDom($(this))
    })
}
$(function() {
    bindCtr($('html'))
});
function gup() {
    var name = arguments[0],
    url = arguments[1] || window.location.href;
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(url);
    if (results == null) {
        return ""
    } else {
        return results[1]
    }
};
function jumpToUrl(url) {
    if (location.href === url) {
        window.location.reload()
    } else {
        window.location.href = url
    }
}
function pug() {
    if (!arguments || typeof arguments[0] != 'object') {
        return
    };
    var param = arguments[0],
    url = arguments[1] || window.location.href;
    for (var i in param) {
        if (!i) {
            continue
        };
        var name = i,
        val = param[i];
        var reg = new RegExp('([\\?&])((' + name + '\=)([\\w\-]+))(&?)', 'i');
        var omatch = url.match(reg);
        if (!val && omatch) { (omatch[5] && omatch[2]) ? url = url.replace(omatch[2] + '&', '') : (omatch[1] && omatch[2]) ? url = url.replace(omatch[0], '') : ''
        }
        if (val && !omatch) {
            url.indexOf('?') > -1 ? url += '&' + name + '=' + val: url += '?' + name + '=' + val
        }
        if (val && omatch && val != omatch[4]) {
            url = url.replace(omatch[2], omatch[3] + val)
        }
    };
    if (!arguments[1] && window.location.href != url) {
        if (location.hash != '') {
            url = url.replace(location.hash, '');
            url += location.hash
        }
        jumpToUrl(url)
    } else {
        return url
    }
};
function addCommas(num) {
    num += '';
    x = num.split('.');
    x1 = x[0];
    x2 = x.length > 1 ? '.' + x[1] : '';
    var rgx = /(\d+)(\d{3})/;
    while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2')
    }
    return x1 + x2
};
function formatPrice(price) {
    price = price - 0;
    function setPrice() {
        price = (parseInt(price) == price) ? price: (Math.round(price * 100) / 100).toFixed(2)
    }
    if (litb.currency === 'RUB') {
        setPrice();
        return addCommas(price).replace(/,/g, ' ').replace('.', ',')
    } else if (litb.currency === 'JPY') {
        price = parseInt(price)
    } else if (litb.currency === 'BRL' || litb.currency === 'CLP' || litb.currency === 'DKK' || litb.currency === 'NOK') {
        setPrice();
        return addCommas(price).replace(/,/g, ' ').replace('.', ',').replace(/\s/g, '.')
    } else {
        setPrice()
    }
    return addCommas(price)
};
function priceToNumber(price) {
    price = price.replace(/\s/g, '');
    if (litb.currency === 'RUB') {
        return price.replace(/,/g, '.')
    } else if (litb.currency === 'BRL' || litb.currency === 'CLP' || litb.currency === 'DKK' || litb.currency === 'NOK') {
        return price.replace(/\./g, '').replace(',', '.')
    } else {
        return price.replace(/,/g, '')
    }
};
function p_StyleModify(price, str) {
    var _price = price + '';
    if (_price.indexOf(str) > 0) {
        var _str = _price.split(str);
        price = _str[0] + str + '<sup>' + _str[1] + '</sup>'
    }
    if (price.indexOf('<sub>') < 0) price = price + '<sup></sup>';
    price = litb['CurrencyList'][litb['currency']] + price;
    return price
};
$.cookie = function(name, value, options) {
    if (typeof value != 'undefined') {
        var _host = location.host;
        var defaults = {
            domain: _host.substr(_host.indexOf('.'), _host.lenght)
        };
        options = $.extend(defaults, options);
        if (value === null) {
            value = '';
            options.expires = -1
        };
        var expires = '';
        if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
            var date;
            if (typeof options.expires == 'number') {
                date = new Date();
                date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000))
            } else {
                date = options.expires
            };
            expires = '; expires=' + date.toUTCString()
        };
        var path = options.path ? '; path=' + (options.path) : '; path=/';
        var domain = options.domain ? '; domain=' + (options.domain) : '';
        var secure = options.secure ? '; secure': '';
        document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('')
    } else {
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = $.trim(cookies[i]);
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break
                }
            }
        }
        return cookieValue
    }
};
$.fn.autocomplete = function(options) {
    var defaults = {
        resultsClass: "searchInstant",
        overClass: "over",
        bottomClass: "ft",
        lineSeparator: ";",
        cellSeparator: "|",
        minChars: 1,
        delay: 50,
        matchCase: 0,
        cacheLength: 10,
        maxItemsToShow: 10,
        extraParams: {}
    };
    var options = $.extend(defaults, options);
    this.each(function() {
        options.url = $(this).attr("qs_url"),
        options.extraParams = {
            lang: $(this).attr("lang")
        };
        input = this;
        var $input = $(input);
        $input.parents('form').submit(function() {
            if ($.trim($input.val()) == '') {
                return false
            }
        });
        var results = document.createElement("div");
        var $results = $(results);
        $results.css("z-index", "8900");
        $results.hide().addClass(options.resultsClass).css("position", "absolute");
        $results.css("width", $input.parents('form').parent().width());
        $("body").prepend(results);
        var timeout = null;
        var prev = "";
        var active = -1;
        var cache = {};
        var keyb = false;
        var hasFocus = false;
        var lastKeyPressCode = null;
        var seq_num = 0;
        var last_received = false;
        function flushCache() {
            cache = {};
            cache.data = {};
            cache.length = 0
        };
        flushCache();
        $input.keyup(function(e) {
            hasFocus = true;
            lastKeyPressCode = e.keyCode;
            if (lastKeyPressCode < 37 || lastKeyPressCode > 40) {
                active = -1;
                if (timeout) clearTimeout(timeout);
                timeout = setTimeout(function() {
                    onChange()
                },
                options.delay)
            }
        }).keydown(function(e) {
            hasFocus = true;
            lastKeyPressCode = e.keyCode;
            switch (e.keyCode) {
            case 13:
                if ($input.val() == "") {
                    $input.val($input.attr("dValue"))
                };
                break;
            case 38:
                e.preventDefault();
                if ($results.is(":visible")) moveSelect( - 1);
                break;
            case 40:
                e.preventDefault();
                if ($results.is(":visible")) moveSelect(1);
                break;
            default:
                break
            }
        }).focus(function() {
            if ($input.val() == $input.attr("dValue")) {
                $input.val("")
            };
            $input.addClass('focus');
            hasFocus = true
        }).blur(function() {
            if ($input.val() == "") {
                $input.removeClass('focus').val($input.attr("dValue"))
            };
            hasFocus = false;
            hideResults()
        });
        function onChange() {
            if ((lastKeyPressCode >= 33 && lastKeyPressCode <= 45) || lastKeyPressCode == 144 || lastKeyPressCode == 145 || lastKeyPressCode == 9 || (lastKeyPressCode >= 112 && lastKeyPressCode <= 135)) return;
            if (lastKeyPressCode == 27) return hideResultsNow();
            var v = $input.val();
            if (v == prev) {
                if (lastKeyPressCode != 46 && (lastKeyPressCode <= 8 || lastKeyPressCode >= 32)) showResults();
                return
            };
            prev = v;
            if (v.length >= options.minChars) {
                requestData(++seq_num, v, last_received = false)
            } else {
                $results.hide()
            }
        };
        function moveSelect(step) {
            var lis = $("li", results);
            if (!lis || lis.length == 0) return;
            active += step;
            if (active < 0) {
                active = lis.size() - 1
            } else if (active >= lis.size()) {
                active = 0
            };
            lis.removeClass(options.overClass);
            $(lis[active]).addClass(options.overClass);
            $input.val(lis[active].selectValue)
        };
        function selectItem(li) {
            var v = $.trim(li.selectValue ? li.selectValue: li.innerHTML);
            prev = v;
            $input.val(v);
            hideResultsNow();
            $input.parents('form')[0].submit()
        };
        function showResults() {
            if (!$input.val()) return;
            $results.css({
                top: ($input.offset().top + $input.outerHeight()) + "px",
                left: $input.parents('form').offset().left + "px"
            }).show()
        };
        function hideResults() {
            if (timeout) clearTimeout(timeout);
            timeout = setTimeout(hideResultsNow, 200)
        };
        function hideResultsNow() {
            if (timeout) clearTimeout(timeout);
            if ($results.is(":visible")) {
                $results.hide()
            }
        };
        function receiveData(q, data, seqNum) {
            if (seqNum == seq_num || (seqNum < seq_num && !last_received)) {
                if (seqNum == seq_num) last_received = true;
                if (data) {
                    results.innerHTML = "";
                    if (!hasFocus || data.length == 0) return hideResultsNow();
                    if ($.browser.msie && $.browser.version < 7) {
                        var iFrame = document.createElement('iframe');
                        iFrame.setAttribute("src", "about:blank");
                        iFrame.style.width = $results.css("width");
                        iFrame.style.height = $results.css("height");
                        $results.append(iFrame)
                    }
                    results.appendChild(dataToDom(q, data));
                    var div = document.createElement("div");
                    div.className = options.bottomClass;
                    results.appendChild(div);
                    showResults()
                } else {
                    results.innerHTML = "";
                    hideResultsNow()
                }
            }
        };
        function parseData(data) {
            if (!data) return null;
            var parsed = [];
            var rows = data.split(options.lineSeparator);
            for (var i = 0; i < rows.length; i++) {
                var row = $.trim(rows[i]);
                if (row) {
                    parsed[parsed.length] = row.split(options.cellSeparator)
                }
            };
            return parsed
        };
        function dataToDom(q, data) {
            var ul = document.createElement("ul");
            var num = data.length;
            if ((options.maxItemsToShow > 0) && (options.maxItemsToShow < num)) num = options.maxItemsToShow;
            for (var i = 0; i < num; i++) {
                var row = data[i];
                if (!row) continue;
                var li = document.createElement("li");
                li.innerHTML = '<span class="b">' + q + '</span>' + row[0].substring(q.length);
                li.selectValue = row[0];
                ul.appendChild(li);
                $(li).hover(function() {
                    $("li", ul).removeClass(options.overClass);
                    $(this).addClass(options.overClass);
                    active = $("li", ul).index(this)
                },
                function() {
                    $(this).removeClass(options.overClass)
                }).click(function(e) {
                    selectItem(this);
                    e.preventDefault();
                    e.stopPropagation()
                })
            };
            return ul
        };
        function requestData(seqNum, q) {
            var data = options.cacheLength ? cache.data[q] : null;
            if (data) {
                receiveData(q, data, seqNum)
            } else if ((typeof options.url == "string") && (options.url.length > 0)) {
                $.getJSON(makeUrl(q),
                function(data) {
                    data = parseData(data);
                    addToCache(q, data);
                    receiveData(q, data, seqNum)
                })
            }
        };
        function makeUrl(q) {
            var ql = (options.matchCase) ? q: q.toLowerCase();
            var url = options.url + "?callback=?&q=" + encodeURIComponent(ql);
            for (var i in options.extraParams) {
                url += "&" + i + "=" + encodeURIComponent(options.extraParams[i])
            };
            return url
        };
        function addToCache(q, data) {
            if (!data || !q || !options.cacheLength) return;
            if (!cache.length || cache.length > options.cacheLength) {
                flushCache();
                cache.length++
            } else if (!cache.data[q]) {
                cache.length++
            };
            cache.data[q] = data
        }
    })
};
$.fn.marquee = function(user_settings) {
    var settings = $.extend({
        time: 3000,
        step: 80
    },
    user_settings);
    var self = $(this);
    var sch = self.attr('scrollHeight');
    self.append(self.html());
    var timeout = null;
    function play() {
        var sct = self.scrollTop();
        if (sct >= sch) self.scrollTop(sct = sct - sch);
        self.animate({
            scrollTop: sct + settings.step - sct % settings.step
        },
        2000,
        function() {
            if (timeout) clearTimeout(timeout);
            timeout = setTimeout(function() {
                play()
            },
            settings.time)
        })
    };
    function stop() {
        clearTimeout(timeout);
        self.stop()
    };
    self.hover(stop, play);
    play()
};
$.fn.magnify = function(params) {
    var setting = $.extend({
        blankHeadHeight: 0,
        detailWidth: 400,
        detailHeight: 360,
        zoomWidth: 3,
        zoomHeight: 3,
        typeWidth: 1140
    },
    params);
    var showing = false,
    scrollLeft = $(window).scrollLeft(),
    scrollTop = $(window).scrollTop(),
    left,
    top,
    anchor = $(this).children('a'),
    width = $('img', this).attr('width'),
    height = $('img', this).attr('height'),
    lenW = setting.detailWidth / setting.zoomWidth,
    lenH = setting.detailHeight / setting.zoomHeight,
    images = {};
    $('<div id="detailImg" style="position:absolute; overflow:hidden; z-index:9990; width:' + setting.detailWidth + 'px; height:' + setting.detailHeight + 'px; left:' + (setting.detailLeft || (width + 10)) + 'px; top:-9999px;"><img width="' + setting.typeWidth + '" height="1500" src="' + litb.resouceURL + 'base-images/transparent.gif" style="position:absolute;" ></div><div id="detailImgLen" style="background-image: url(' + litb.resouceURL + 'base-images/len.gif); position: absolute; cursor: pointer; top:-9999px; width:' + lenW + 'px; height:' + lenH + 'px; left:0;"></div>').appendTo(this);
    var detailEL = $('#detailImg'),
    imgEL = detailEL.children('img')[0],
    lenEL = $('#detailImgLen');
    detailEL.ie6bgiframe();
    function preload(src) {
        var img = new Image();
        img.onload = function() {
            images[src] = true
        };
        images[src] = false;
        img.src = src
    };
    $(this).mouseleave(function(e) {
        lenEL.css('top', '-9999px');
        detailEL.css('top', '-9999px');
        showing = false
    }).mousemove(function(e) {
        if (!showing) {
            if (!anchor.attr('href')) return;
            var src = anchor.attr('href').replace('images/v/', 'images/1500x1500/');
            if (!images[src]) {
                if (typeof(images[src]) === 'undefined') preload(src);
                return
            };
            imgEL.src = src;
            left = $(this).offset().left;
            top = $(this).offset().top;
            detailEL.css({
                top: (setting.blankHeadHeight)
            });
            showing = true
        };
        if (e.clientX + scrollLeft > width + left) {
            $(this).trigger('mouseleave');
            return
        };
        var x = e.clientX + scrollLeft - left,
        y = e.clientY + scrollTop - top;
        if (x < lenW / 2) x = 0;
        else if (x > width - lenW / 2) x = width - lenW;
        else x -= lenW / 2;
        if (y < lenH / 2) y = 0;
        else if (y > height - lenH / 2) y = height - lenH;
        else y -= lenH / 2;
        lenEL.css({
            left: x,
            top: y
        });
        imgEL.style.left = -setting.zoomWidth * x + 'px';
        imgEL.style.top = -setting.zoomHeight * y + 'px'
    });
    $(window).scroll(function() {
        scrollLeft = $(window).scrollLeft();
        scrollTop = $(window).scrollTop()
    })
};
function pageWaiting(params) {
    params = $.extend({
        overlayOpacity: 0,
        timeoutToShow: 1000
    },
    params);
    $('<div id="page-overlay"></div><div id="page-waiting"></div>').appendTo('body');
    if ($.browser.msie && $.browser.version < 7) {
        $('#page-overlay').css({
            position: 'absolute',
            height: $(document).height()
        }).ie6bgiframe();
        $('#page-waiting').css({
            'position': 'absolute',
            'top': Math.max(0, $(window).scrollTop() + $(window).height() / 2 - $('#page-waiting').height() / 2),
            'left': Math.max(0, $(window).scrollLeft() + $(window).width() / 2 - $('#page-waiting').width() / 2)
        })
    } else {
        $('#page-waiting').css({
            'top': Math.max(0, $(window).height() / 2 - $('#page-waiting').height() / 2),
            'left': Math.max(0, $(window).width() / 2 - $('#page-waiting').width() / 2)
        })
    };
    $('#page-overlay').css('opacity', params.overlayOpacity).show();
    var timeout = setTimeout(function() {
        $('#page-waiting').show()
    },
    params.timeoutToShow);
    this.close = function() {
        clearTimeout(timeout);
        $('#page-waiting').remove();
        $('#page-overlay').remove()
    }
};
function popupTracking(a, b, c) {
    if (a != "") {
        a['pos'] = b + 1;
        a['entity'] = c;
        tracking(a)
    }
};
function popup(setting) {
    var pp = this;
    pp.params = $.extend({
        overlayOpacity: 0.4,
        overlayBgColor: '#3F4C58',
        width: Math.min(900, $(window).width() - 100),
        height: Math.max(600, $(window).height() - 50),
        btnSize: 18,
        thumbSize: 0,
        thumbWidth: 0,
        thumbDim: {
            width: 42,
            height: 42
        },
        topSpace: 26,
        html: '',
        imageUrl: '',
        thumblists: [],
        images: [],
        title: '',
        tracking: '',
        specialStyle: '',
        showBtn: false,
        type: 0,
        closeWhenClickingBg: true
    },
    setting);
    pp.params.index = 0;
    if ($('#lightboxOverlay').size() > 0) {
        pp.layer = $('#lightboxOverlay')
    } else {
        pp.layer = $('<div id="lightboxOverlay"><div style="background:' + pp.params.overlayBgColor + ';"></div></div>').prependTo('body');
        var html = ['<div id="lightbox" ctr="{area:\'product_images_popup\',type:\'PIMG\'}">', '<div id="lb-borderBg"></div>', '<div id="lb-wrapper">', '<div id="lb-title"></div>', '<div id="lb-content"  ctr="{area:\'product_images_popup\'}">', '<div id="contentHere" oncontextmenu="return false">', '<img src="' + litb.resouceURL + 'base-images/transparent.gif">', '</div>', '<div id="lb-contentControls">', '<a href="javascript:void(0)" id="lb-previous" ctr="{type:\'PRE_NEXT\'}" entity="pre_arrow"></a>', '<a href="javascript:void(0)" id="lb-next" ctr="{type:\'PRE_NEXT\'}" entity="next_arrow"></a>', '</div>', '</div>', '<div id="lb-thumbnail">', '<div id="lb-thumbnailContent"></div>', '<div id="lb-tnControls">', '<a href="javascript:void(0)" id="lb-tnPrevious" entity="thumbs_pre_arrow" ctr="{type:\'PRE_NEXT\'}" class="hasItem"><span></span></a>', '<a href="javascript:void(0)" id="lb-tnNext" entity="thumbs_next_arrow" ctr="{type:\'PRE_NEXT\'}" class="hasItem"><span></span></a>', '</div>', '</div>', '<a href="" class="noCtrTrack" id="lb-close"></a>', '</div>', '</div>'];
        pp.layer.after(html.join(''))
    };
    pp.winbox = $('#lightbox');
    pp.main = $('#lb-content');
    pp.title = $('#lb-title');
    pp.wrapper = $('#lb-wrapper');
    pp.mainShow = $('#contentHere').html('<img src="' + litb.resouceURL + 'base-images/transparent.gif">');
    pp.thumblist = $('#lb-thumbnail');
    pp.thumblistCon = $('#lb-thumbnailContent');
    pp.btnPre = $('#lb-previous');
    pp.btnNext = $('#lb-next');
    pp.ttnPre = $('#lb-tnPrevious');
    pp.ttnNext = $('#lb-tnNext');
    pp.btnPre.removeAttr('style');
    pp.btnNext.removeAttr('style');
    pp.ttnPre.removeAttr('style');
    pp.ttnNext.removeAttr('style');
    pp.winbox.removeAttr('style').removeClass('lb-thumbnaiRight');
    pp.main.removeAttr('style');
    pp.mainShow.removeAttr('style');
    pp.thumblist.removeAttr('style').hide();
    pp.thumblistCon.removeAttr('style');
    pp.wrapper.removeAttr('style');
    pp.layer.unbind();
    pp.mainShow.unbind();
    pp.btnPre.unbind();
    pp.btnNext.unbind();
    pp.ttnPre.unbind();
    pp.ttnNext.unbind();
    if (pp.params.imageUrl != '') {
        pp.params.index = $.inArray(pp.params.imageUrl, pp.params.images)
    };
    if (pp.params.closeWhenClickingBg) pp.layer.bind('click',
    function() {
        pp.hide()
    });
    $('#lb-close').unbind().bind('click',
    function() {
        pp.hide();
        return false
    });
    this.updateThumblistBtns = function() {
        pp.thumblistCon.children('a.current').removeClass('current');
        pp.thumblistCon.children('a').eq(pp.params.index).addClass('current').end().eq(pp.params.index + pp.params.images.length).addClass('current')
    };
    this.getDefaultImgWidth = function() {
        return gup('w', pp.params.images[pp.params.index])
    };
    this.getDefaultImgHeight = function() {
        return gup('h', pp.params.images[pp.params.index])
    };
    this.imgLoaded = function() {};
    this.reloadImage = function() {
        pp.params.index = (pp.params.index + pp.params.images.length) % pp.params.images.length;
        pp.updateThumblistBtns();
        pp.mainShow.removeAttr('style');
        if (pp.params.html != "") {
            pp.mainShow.html(pp.params.html)
        } else {
            pp.mainShow.unbind('mousemove').children('img').preLoad({
                w: pp.getDefaultImgWidth(),
                h: pp.getDefaultImgHeight(),
                src: pp.params.images[pp.params.index],
                success: pp.imgLoaded
            })
        }
    };
    this.hide = function() {
        pp.thumblist.hide();
        pp.winbox.hide().removeClass();
        pp.wrapper.addClass().removeClass();
        pp.layer.children('div').stop().fadeTo("fast", 0.1,
        function() {
            pp.layer.hide()
        })
    };
    this.show = function() {
        if (pp.params.images.length > 1) $('#lb-contentControls>a').show();
        if ($.browser.msie && $.browser.version < 7) {
            $('#lb-borderBg').hide();
            pp.layer.css({
                position: 'absolute',
                height: $(document).height()
            });
            pp.layer.append().ie6bgiframe()
        };
        pp.layer.show().children('div').stop().fadeTo(0, 0.1).fadeTo("fast", pp.params.overlayOpacity);
        pp.center();
        function hidePP(e) {
            var unicode = e.keyCode ? e.keyCode: e.charCode;
            if (unicode == 27) {
                pp.hide();
                $('#resultsEmail').hide();
                $(document).unbind('keydown', hidePP)
            }
        };
        $(document).keydown(hidePP);
        pp.setBtnIndex();
        bindCtr(pp.winbox);
        if (pp.params.type == 1 || pp.params.specialStyle != '') {
            trackingShowDom($('#lb-content'))
        }
        return this
    };
    this.center = function() {
        pp.winbox.show().css({
            "top": Math.max(0, $(window).scrollTop() + $(window).height() / 2 - Math.max(pp.winbox.height(), pp.params.height) / 2),
            "left": Math.max(0, $(window).scrollLeft() + $(window).width() / 2 - pp.winbox.width() / 2)
        })
    };
    this.setBtnIndex = function() {
        var _size = pp.thumblistCon.children('a').size(),
        _Pre = _size,
        _Next = 2;
        _Pre = parseInt((pp.params.index == -1) ? (_size - 1) : (pp.params.index == 0) ? _size: pp.params.index);
        _Next = parseInt((pp.params.index == _size) ? 2 : (pp.params.index == (_size - 1)) ? 1 : parseInt(pp.params.index) + 2);
        if (pp.params.type == 1 && (_Pre > _size / 2) && pp.params.showBtn) {
            _Pre = _Pre - _size / 2
        }
        if (pp.params.type == 1 && (_Next > _size / 2) && pp.params.showBtn) {
            _Next = _Next - _size / 2
        }
        pp.btnPre.attr({
            ctr: '{pos:' + _Pre + '}'
        });
        pp.btnNext.attr({
            ctr: '{pos:' + _Next + '}'
        })
    }
};
function HtmlPopup(setting) {
    var pp = this;
    popup.call(this, setting);
    this.prepare = function() {
        $('#lb-wrapper').css({
            "width": pp.params.width
        });
        pp.main.css({
            "width": pp.params.width - pp.params.thumbSize,
            "overflow": 'hidden'
        })
    };
    pp.prepare();
    pp.reloadImage()
};
function SinglePopup(setting) {
    var pp = this;
    popup.call(this, setting);
    this.prepare = function() {
        pp.main.css({
            'width': pp.getDefaultImgWidth(),
            'height': pp.getDefaultImgHeight()
        });
        pp.main.hover(function() {
            $('#lb-contentControls').show()
        },
        function() {
            $('#lb-contentControls').hide()
        });
        pp.btnPre.bind('click',
        function() {
            pp.params.index--;
            pp.reloadImage();
            return false
        });
        pp.btnNext.bind('click',
        function() {
            pp.params.index++;
            pp.reloadImage();
            return false
        })
    };
    pp.prepare();
    pp.reloadImage()
};
function NormalPopup(setting) {
    var pp = this,
    scrolling = false;
    popup.call(this, setting);
    this.getDefaultImgWidth = function() {
        return pp.params.imgWidth || pp.params.width
    };
    this.getDefaultImgHeight = function() {
        return pp.params.imgHeight || pp.params.height
    };
    function left() {
        if (scrolling) return;
        scrolling = true;
        var mt = pp.thumblistCon.css('marginLeft').replace('px', '') - pp.params.thumbWidth;
        pp.thumblistCon.animate({
            marginLeft: mt
        },
        'fast',
        function() {
            if (mt <= -pp.thumblistCon.children('a').size() / 2 * pp.params.thumbWidth) pp.thumblistCon.css('marginLeft', 0);
            scrolling = false
        })
    };
    function right() {
        if (scrolling) return;
        scrolling = true;
        var mt = pp.thumblistCon.css('marginLeft').replace('px', '');
        if (mt >= 0) pp.thumblistCon.css('marginLeft', -pp.thumblistCon.children('a').size() / 2 * pp.params.thumbWidth);
        pp.thumblistCon.animate({
            marginLeft: parseInt(pp.thumblistCon.css('marginLeft').replace('px', '')) + pp.params.thumbWidth
        },
        'fast',
        function() {
            scrolling = false
        })
    };
    this.prepare = function() {
        pp.params.showBtn = pp.params.width < pp.params.thumblists.length * pp.params.thumbWidth;
        if (pp.params.height + pp.params.thumbSize > $(window).height()) {
            pp.params.height -= pp.params.thumbSize / 2
        };
        $('#lb-wrapper').css({
            "width": pp.params.width,
            "height": pp.params.height + pp.params.thumbSize
        });
        pp.main.css({
            "width": pp.params.width,
            "height": pp.params.height,
            "overflow": 'hidden'
        });
        pp.btnPre.bind('click',
        function() {
            if (pp.params.showBtn && scrolling) return;
            pp.params.index--;
            pp.setBtnIndex();
            pp.reloadImage();
            if (pp.params.showBtn) right();
            return false
        });
        pp.btnNext.bind('click',
        function() {
            if (pp.params.showBtn && scrolling) return;
            pp.params.index++;
            pp.setBtnIndex();
            pp.reloadImage();
            if (pp.params.showBtn) left();
            return false
        });
        pp.thumblist.show();
        var ths = '';
        $(pp.params.thumblists).each(function(a, b) {
            ths += '<a><img width="' + pp.params.thumbDim.width + '" height="' + pp.params.thumbDim.height + '" src="' + b + '" /></a>'
        });
        pp.thumblistCon.children('a').remove();
        pp.thumblistCon.append(ths);
        pp.thumblist.css('height', pp.params.thumbSize);
        if (pp.params.showBtn) {
            pp.thumblistCon.append(pp.thumblistCon.html());
            pp.thumblistCon.css({
                position: 'absolute',
                width: pp.params.thumblists.length * 2 * pp.params.thumbWidth
            });
            pp.thumblistCon.css('marginLeft', -pp.params.index * pp.params.thumbWidth);
            pp.ttnPre.click(right);
            pp.ttnNext.click(left)
        } else {
            pp.ttnPre.hide();
            pp.ttnNext.hide();
            pp.thumblistCon.css({
                position: 'absolute',
                width: pp.params.thumblists.length * pp.params.thumbWidth
            });
            pp.thumblistCon.css('marginLeft', -pp.params.btnSize)
        };
        pp.thumblistCon.children('a').each(function(n) {
            $(this).click(function() {
                if (pp.params.index == (n + pp.params.images.length) % pp.params.images.length) return;
                pp.params.index = n;
                pp.setBtnIndex();
                pp.reloadImage();
                if (pp.params.showBtn) left()
            }).attr({
                ctr: '{pos:' + (parseInt(n) + 1) + '}',
                entity: 'thumbs'
            })
        });
        pp.title.html(pp.params.title);
        if (pp.params.specialStyle != '') {
            pp.winbox.addClass('ctrInfo ctrTrackShow');
            pp.wrapper.addClass('ctrTrackA');
            pp.winbox.addClass(pp.params.specialStyle[0]);
            pp.main.css('width', pp.params.specialStyle[1]);
            pp.thumblist.css('height', pp.params.specialStyle[2]);
            pp.thumblistCon.css('width', pp.params.specialStyle[3])
        }
        pp.updateThumblistBtns()
    };
    pp.prepare();
    pp.reloadImage()
};
function VerticalPopup(setting) {
    var pp = this,
    scrolling = false;
    popup.call(this, setting);
    this.getDefaultImgWidth = function() {
        return pp.params.width - pp.params.thumbSize
    };
    this.getDefaultImgHeight = function() {
        return pp.params.height
    };
    pp.winbox.addClass('verticalPop ctrInfo ctrTrackShow');
    pp.wrapper.addClass('ctrTrackA');
    function up() {
        if (scrolling) return;
        scrolling = true;
        var mt = pp.thumblistCon.css('marginTop').replace('px', '') - pp.params.thumbWidth;
        pp.thumblistCon.animate({
            marginTop: mt
        },
        'fast',
        function() {
            if (mt <= -pp.thumblistCon.children('a').size() / 2 * pp.params.thumbWidth) pp.thumblistCon.css('marginTop', 0);
            scrolling = false
        })
    };
    function down() {
        if (scrolling) return;
        scrolling = true;
        var mt = pp.thumblistCon.css('marginTop').replace('px', '');
        if (mt >= 0) pp.thumblistCon.css('marginTop', -pp.thumblistCon.children('a').size() / 2 * pp.params.thumbWidth);
        pp.thumblistCon.animate({
            marginTop: parseInt(pp.thumblistCon.css('marginTop').replace('px', '')) + pp.params.thumbWidth
        },
        'fast',
        function() {
            scrolling = false
        })
    };
    this.imgLoaded = function(dim) {
        var rw = dim.w,
        rh = dim.h;
        pp.mainShow.css({
            marginLeft: (pp.params.width - pp.params.thumbSize - rw) / 2,
            marginTop: 0
        }).children('img').attr({
            width: rw,
            height: rh
        });
        setTimeout(floatImg, 10)
    };
    function scrollHandler() {
        offX = pp.main.offset().left - $(window).scrollLeft();
        offY = pp.main.offset().top - $(window).scrollTop()
    };
    function floatImg(clickEvent) {
        var myW = pp.main.width(),
        myH = pp.main.height();
        pp.winbox.scroll(scrollHandler).trigger('scroll');
        pp.mainShow.unbind('mousemove').mousemove(function(e) {
            pp.mainShow.css({
                textAlign: 'left',
                'margin-top': (offY - e.clientY) * (1500 - myH) / myH,
                'margin-left': (offX - e.clientX) * (1140 - myW) / myW
            })
        })
    };
    this.prepare = function() {
        pp.params.showBtn = (pp.params.height - pp.params.btnSize * 2 - pp.params.topSpace) < pp.params.thumblists.length * pp.params.thumbWidth;
        $('#lb-wrapper').css({
            "width": pp.params.width,
            "height": pp.params.height
        });
        pp.main.css({
            "width": pp.params.width - pp.params.thumbSize,
            "height": pp.params.height,
            "overflow": 'hidden'
        });
        pp.main.hover(function() {
            $('#lb-contentControls').show()
        },
        function() {
            $('#lb-contentControls').hide()
        });
        pp.btnPre.bind('click',
        function() {
            if (pp.params.showBtn && scrolling) return;
            pp.params.index--;
            pp.setBtnIndex();
            pp.reloadImage();
            if (pp.params.showBtn) down();
            return false
        });
        pp.btnNext.bind('click',
        function() {
            if (pp.params.showBtn && scrolling) return;
            pp.params.index++;
            pp.setBtnIndex();
            pp.reloadImage();
            if (pp.params.showBtn) up();
            return false
        });
        pp.thumblist.show();
        var ths = '';
        $(pp.params.thumblists).each(function(a, b) {
            ths += '<a><img width="' + pp.params.thumbDim.width + '" height="' + pp.params.thumbDim.height + '" src="' + b + '" /></a>'
        });
        pp.thumblistCon.children('a').remove();
        pp.thumblistCon.append(ths);
        pp.winbox.addClass('lb-thumbnaiRight');
        pp.thumblist.css({
            width: pp.params.thumbSize,
            height: pp.params.height - pp.params.btnSize * 2 - pp.params.topSpace
        });
        if (pp.params.showBtn) {
            pp.thumblistCon.append(pp.thumblistCon.html());
            pp.thumblistCon.css({
                position: 'relative',
                height: pp.params.thumblists.length * 2 * pp.params.thumbWidth
            });
            pp.thumblistCon.css('marginTop', -pp.params.index * pp.params.thumbWidth);
            pp.ttnPre.click(down);
            pp.ttnNext.click(up)
        } else {
            pp.ttnPre.hide();
            pp.ttnNext.hide();
            pp.thumblistCon.css({
                position: 'relative',
                height: pp.params.thumblists.length * pp.params.thumbWidth
            })
        };
        pp.thumblistCon.children('a').each(function(n) {
            var _s = pp.thumblistCon.children('a').size(),
            t = n;
            if (t >= _s / 2 && pp.params.showBtn) {
                t = n - _s / 2
            }
            $(this).click(function() {
                if (pp.params.index == (n + pp.params.images.length) % pp.params.images.length) return;
                pp.params.index = n;
                pp.setBtnIndex();
                pp.reloadImage();
                if (pp.params.showBtn) up()
            }).attr({
                ctr: '{pos:' + (parseInt(t) + 1) + '}',
                entity: 'thumbs'
            })
        });
        pp.updateThumblistBtns()
    };
    pp.prepare();
    pp.reloadImage()
};
litb.preLoadImages = {};
$.fn.preLoad = function(setting) {
    if (!setting.src) return;
    var el = $(this),
    params = $.extend({
        success: function() {},
        failure: function() {}
    },
    setting);
    el.data('src', params.src);
    if (litb.preLoadImages[params.src] && litb.preLoadImages[params.src].loaded) {
        el.removeAttr("style");
        el.attr({
            'width': litb.preLoadImages[params.src].img.width,
            'height': litb.preLoadImages[params.src].img.height,
            'src': params.src
        });
        params.success({
            w: litb.preLoadImages[params.src].img.width,
            h: litb.preLoadImages[params.src].img.height
        });
        return
    };
    var w = el.attr('width'),
    h = el.attr('height'),
    params = $.extend({
        w: w,
        h: h
    },
    params);
    el.attr({
        'src': litb.resouceURL + 'base-images/transparent.gif',
        'width': params.w,
        'height': params.h,
        'style': 'background:url("' + litb.resouceURL + 'base-images/popup-loading.gif") no-repeat 50% 50%'
    });
    if (!litb.preLoadImages[params.src]) {
        var img = new Image();
        litb.preLoadImages[params.src] = {
            img: img,
            loaded: false
        };
        img.onload = function() {
            litb.preLoadImages[params.src].loaded = true;
            if (params.src != el.data('src')) return;
            el.removeAttr("style");
            el.attr({
                'width': this.width,
                'height': this.height,
                'src': params.src
            });
            params.success({
                w: this.width,
                h: this.height
            })
        };
        img.onerror = function() {
            litb.preLoadImages[params.src] = null;
            if (params.src != el.data('src')) return;
            el.removeAttr("style");
            el.attr('src', litb.resouceURL + 'base-images/300x300.png');
            params.failure()
        };
        img.src = params.src
    }
};
$.fn.PageBar = function(options, cbGotoPage) {
    var sets = {
        barType: 'simple',
        curPage: 1,
        pageSize: 10
    };
    if (options) {
        $.extend(sets, options)
    };
    var $self = $(this);
    var pageCount = parseInt((sets.totalCount - 1) / sets.pageSize + 1);
    if (pageCount <= 1) return;
    curPage = sets.curPage;
    if (curPage < 1) curPage = 1;
    if (pageCount < curPage) curPage = pageCount;
    switch (sets.barType) {
    case 'simple':
        showSimpleNav($(this));
        break;
    case 'all':
        showAllNav();
        break
    };
    function showSimpleNav() {
        $self.html('<ul><li class="pageIndex"><span>' + litb.langs.pageBar.page + '<b> ' + curPage + ' </b> ' + litb.langs.pageBar.of + ' <b>' + pageCount + '</b></span></li></ul>');
        if (curPage > 1) {
            var $prev = $('<li class="pageControl previous"><a href="#"><span>' + litb.langs.pageBar.prev + '</span></a></li>');
            $prev.bind('click',
            function() {
                cbGotoPage(curPage - 1);
                return false
            });
            $self.children('ul').prepend($prev)
        };
        if (curPage < pageCount) {
            var $next = $('<li class="pageControl next"><a href="#"><span>' + litb.langs.pageBar.next + '</span></a></li>');
            $next.bind('click',
            function() {
                cbGotoPage(curPage + 1);
                return false
            });
            $self.children('ul').append($next)
        }
    };
    function showAllNav() {
        $self.html('<ul class="clearfix"><li class="pageIndex"></li></ul>');
        if (pageCount <= 10) {
            for (var p = 1; p <= pageCount; p++) showPageBtn(p)
        } else {
            if (curPage > 1) {
                showPrevPageBtn()
            };
            if (curPage < 5) {
                for (var p = 1; p <= curPage; p++) showPageBtn(p)
            } else {
                showPageBtn(1);
                $self.find('.pageIndex').append('<span>...</span>');
                showPageBtn(curPage - 2);
                showPageBtn(curPage - 1);
                showPageBtn(curPage)
            };
            if (curPage + 3 >= pageCount) {
                for (var p = curPage + 1; p <= pageCount; p++) showPageBtn(p)
            } else {
                var end = curPage < 3 ? 5 : curPage + 2;
                for (var p = curPage + 1; p <= end; p++) showPageBtn(p);
                $self.find('.pageIndex').append('<span>...</span>');
                showPageBtn(pageCount)
            };
            if (curPage < pageCount) {
                showNextPageBtn()
            }
        }
    };
    function showPageBtn(p) {
        if (curPage == p) $self.find('.pageIndex').append('<strong>' + p + '</strong>');
        else {
            $page = $('<a href="">' + p + '</a>');
            $page.bind('click',
            function() {
                cbGotoPage(p);
                return false
            });
            $self.find('.pageIndex').append($page)
        }
    };
    function showPrevPageBtn() {
        $prev = $('<li class="pageControl previous"><a href="#"><span>' + litb.langs.pageBar.prev + '</span></a></li>');
        $prev.bind('click',
        function() {
            cbGotoPage(curPage - 1);
            return false
        });
        $self.children('ul').prepend($prev)
    };
    function showNextPageBtn() {
        $next = $('<li class="pageControl next"><a href="#"><span>' + litb.langs.pageBar.next + '</span></a></li>');
        $next.bind('click',
        function() {
            cbGotoPage(curPage + 1);
            return false
        });
        $self.children('ul').append($next)
    }
};
$.fn.backToTop = function(setting) {
    if ($.browser.msie && $.browser.version < 7) return;
    var params = $.extend({
        'id': $(this).attr('id'),
        'left': $(this).width() + $(this).offset().left,
        'bottom': '50px',
        show: true
    },
    setting);
    $(document).ready(function($) {
        var topBtn = $('<div id="topControl" entity="back_to_top" class="srcollShow" ctr="{area:\'back_to_top\',type:\'BACK_TO_TOP\'}"></div>').appendTo($('body'));
        topBtn.css({
            'position': 'fixed',
            left: params.left,
            bottom: params.bottom
        }).click(function() {
            $('html, body').animate({
                scrollTop: 0
            },
            '1000');
            trackingClickDom($(this))
        }).hide();
        $(window).scroll(function() {
            if ($(this).scrollTop() != 0) {
                topBtn.show().fadeIn();
                if (params.show) {
                    trackingShowDom($('#topControl'));
                    params.show = false
                }
            } else {
                topBtn.fadeOut();
                params.show = true
            }
        }).resize(function() {
            topBtn.css('left', $('#' + params.id).width() + $('#' + params.id).offset().left)
        })
    })
};
String.prototype.stringFormat = function() {
    var formatted = this;
    for (var i = 0; i < arguments.length; i++) {
        var regexp = new RegExp('\\{' + i + '\\}', 'gi');
        formatted = formatted.replace(regexp, arguments[i])
    };
    return formatted
};
$.fn.formCheck = function(items, params, type) {
    if (!params) params = {};
    params.rules = $.extend({
        'null': function(obj, checks) {
            return $.trim($(obj).val()).length > 0
        },
        'maxlength': function(obj, checks) {
            return $.trim($(obj).val()).length <= checks.maxlength
        },
        'minlength': function(obj, checks) {
            return $.trim($(obj).val()).length >= checks.minlength
        },
        'digitMinlength': function(obj, checks) {   //
            return $.trim($(obj).val().replace(/[^0-9]/g, '')).length >= checks.minlength
        },
        'email': function(obj, checks) {
            return /(\,|^)([\w+._]+@\w+\.(\w+\.){0,3}\w{2,4})/.test($(obj).val().replace(/-|\//g, ''))
        },
        'checked': function(obj, checks) {
            return obj.checked
        },
        'phone': function(obj, checks) {
            return /^[\d-\s]{1,20}$/.test($(obj).val()) && $.trim($(obj).val()).replace(/[\s]+/g, ' ').length <= checks.maxlength
        },
        'number': function(obj, checks) {
            return /^[0-9]+$/.test($.trim($(obj).val()))
        },
        'min': function(obj, checks) {
            return parseInt($(obj).val()) >= checks.min
        },
        'select': function(obj, checks) {
            return $(obj).val() != checks.value
        },
        'user': function(obj, checks) {
            return /^(?!\d)[a-zA-Z0-9\u4e00-\u9fa5_]{5,18}$/.test($.trim($(obj).val()))
        }
    },
    params.rules);
    var result = true,
    focused = false;
    function checkItem(item, checks) {
        for (j in checks) {
            if (params.rules[checks[j].type]) if (params.rules[checks[j].type](item, checks[j])) continue;
            if (!focused && !checks[j].noFocus) {
                if ($(item).offset().top < $(window).scrollTop()) {
                    $('html, body').animate({
                        scrollTop: $(item).offset().top
                    },
                    'fast')
                }
                focused = true
            };
            if (checks[j].showError) {
                checks[j].showError();
                result = false;
                break
            } else if (params.showError) {
                params.showError($(item), checks[j].errMsg);
                result = false;
                break
            } else if (params.errinfoFinder) {
                params.errinfoFinder($(item)).text(checks[j].errMsg);
                $(item).focus(function() {
                    params.errinfoFinder($(item)).text('')
                });
                if ($(item).attr('type') != null && $(item).attr('type').toLowerCase() == 'checkbox') {
                    $(item).click(function() {
                        $(item).focus()
                    })
                };
                result = false;
                break
            } else if (checks[j].errMsg) {
                alert(checks[j].errMsg);
                return false
            }
        };
        return true
    };
    function checkElm(elm) {
        for (i = 0; i < elm.length; i++) {
            if ($(elm[i]).attr('name') && $(elm[i]).attr('name').length == 0 || $(elm[i]).attr('disabled')) continue;
            var checks = items[$(elm[i]).attr('name')];
            if (!checks) continue;
            if (!checkItem(elm[i], checks)) return false
        }
    }
    if (type) {
        for (n = 0; n < type.length; n++) {
            checkElm(this.find(type[n]))
        }
    } else {
        checkElm(this[0])
    }
    return result
};
$.fn.tooltip = function(options) {
    options = $.extend({
        toolClass: '',
        locate: '',
        hoverHide: false,
        top: 10,
        forceTop: false
    },
    options);
    var tid = (options.close) ? 'park': '',
    bindEvent = (options.close) ? 'click': 'mouseover';
    var sel = '#tooltip' + tid,
    closeSel = sel + ' .close',
    arrowSel = sel + ' .arrow';
    $(this).each(function() {
        $(this).bind(bindEvent,
        function() {
            if ($(sel).size() == 0) {
                $('body').prepend('<div id="tooltip' + tid + '" class="tooltip ' + options.toolClass + '"><span class="close"></span><span class="arrow"></span><div></div></div>');
                $(closeSel).click(function() {
                    $(sel).hide()
                })
            }
            if (!options.close) {
                $(closeSel).hide();
                if (options.hoverHide) {
                    $(options.hoverObj).hover(function() {},
                    function() {
                        $(sel).hide()
                    });
                    $(sel).hover(function() {
                        $(this).show()
                    },
                    function() {
                        $(this).hide()
                    })
                } else {
                    $(this).mouseout(function() {
                        $(sel).hide()
                    })
                }
            };
            $(sel + ' div').html(options.html);
            $(sel).css({
                top: -9999,
                width: options.width
            }).show().ie6bgiframe({
                width: $(sel).width() + 2,
                height: $(sel).height() + 2
            });
            function findTotalOffset(obj) {
                var ol = ot = 0;
                if (obj.offsetParent) {
                    do {
                        ol += obj.offsetLeft;
                        ot += obj.offsetTop
                    } while ( obj = obj . offsetParent )
                };
                return {
                    left: ol,
                    top: ot
                }
            };
            var offset = findTotalOffset(this),
            width = $(this).width() + parseInt($(this).css("padding-left")) + parseInt($(this).css("padding-right")),
            height = $(this).height() + parseInt($(this).css("padding-top")) + parseInt($(this).css("padding-bottom")),
            correctLeft = '',
            attowRight = '';
            if (options.locate === 'center') {
                correctLeft = offset.left + width / 2 - $(sel).outerWidth() / 2
            } else {
                correctLeft = offset.left;
                attowRight = 26
            }
            switch (options.position) {
            case 'vertical':
                if (options.locate === 'center') {
                    $(sel).css({
                        left: correctLeft
                    });
                    $(arrowSel).css({
                        left: $(sel).outerWidth() / 2 - 9
                    })
                } else if (offset.left < $(window).width() / 2) {
                    if (width >= 30) $(sel).css({
                        left: correctLeft
                    });
                    else $(sel).css({
                        left: correctLeft - 28 + width / 2
                    });
                    $(arrowSel).css({
                        left: 18
                    })
                } else {
                    if (width >= 30) $(sel).css({
                        left: correctLeft + width - $(sel).outerWidth()
                    });
                    else $(sel).css({
                        left: correctLeft + width - $(sel).outerWidth() + 35 - width / 2
                    });
                    $(arrowSel).css({
                        left: 'auto',
                        right: attowRight
                    })
                };
                if ((offset.top + height + $(sel).height() + 52 - $(window).scrollTop() <= $(window).height() || offset.top - $(sel).height() - 52 < $(window).scrollTop()) && !options.forceTop) {
                    $(sel).css({
                        top: offset.top + height + options.top
                    });
                    $(arrowSel).css({
                        top: -9,
                        backgroundPosition: '-441px -407px'
                    })
                } else {
                    $(sel).css({
                        top: offset.top - $(sel).outerHeight() - $(arrowSel).outerHeight(true)
                    });
                    $(arrowSel).css({
                        top: 'auto',
                        bottom: -16,
                        backgroundPosition: '-410px -407px'
                    })
                };
                break;
            case 'horizontal':
                if (offset.left < $(window).width() / 2) {
                    $(sel).css({
                        left: offset.left + width + 15
                    });
                    $(arrowSel).css({
                        left: -7,
                        backgroundPosition: '-379px -396px'
                    })
                } else {
                    $(sel).css({
                        left: offset.left - options.width - 47
                    });
                    $(arrowSel).css({
                        left: 'auto',
                        right: -20,
                        backgroundPosition: '-348px -396px'
                    })
                };
                if (offset.top + height + $(sel).height() + 47 - $(window).scrollTop() <= $(window).height() || offset.top - $(sel).height() - 52 < $(window).scrollTop()) {
                    $(sel).css({
                        top: offset.top - 25
                    });
                    $(arrowSel).css({
                        top: 25
                    })
                } else {
                    $(sel).css({
                        top: offset.top - $(sel).height() - 7
                    });
                    $(arrowSel).css({
                        top: 'auto',
                        bottom: 15
                    })
                };
                break
            };
            return false
        })
    })
};
$.fn.hovertip = function(options) {
    var $me = $(this),
    me = this;
    this.sets = {
        top: 0,
        left: 0,
        arrLeft: 0,
        width: 100,
        arrow: '',
        arrowHtml: '',
        locate: '',
        hover: true
    };
    if (options) {
        $.extend(me.sets, options)
    };
    if (!$('#hovertip')[0]) $('body').prepend('<div id="hovertip" class="hovertip"></div>');
    function findTotalOffset(obj) {
        var ol = ot = 0;
        if (obj.offsetParent) {
            do {
                ol += obj.offsetLeft;
                ot += obj.offsetTop
            } while ( obj = obj . offsetParent )
        };
        return {
            left: ol,
            top: ot
        }
    };
    var arrLeft = 0;
    if (me.sets.arrow != '') {
        me.sets.arrowHtml = '<span class="arrow" style="width:' + me.sets.width + 'px;background-position:' + (me.sets.width / 2 + me.sets.arrLeft) + 'px 0px;"></span>'
    }
    $(this).hover(function() {
        var _obj = findTotalOffset(this);
        $('#hovertip').html(me.sets.arrowHtml + me.sets.html).css({
            top: (_obj.top + me.sets.top),
            left: (_obj.left + me.sets.left),
            width: me.sets.width
        }).show();
        if (me.sets.locate == 'top') {
            if (litb.lan == 'he' || litb.lan == 'ar') {
                $('#hovertip').css({
                    top: _obj.top - $me.height() - $('#hovertip').height() - 27
                }).find('.arrow').addClass('arrowBottom').attr({
                    'style': 'width:' + me.sets.width + 'px;background-position:' + (me.sets.width / 2 + me.sets.arrLeft - 30) + 'px -30px;'
                })
            } else {
                $('#hovertip').css({
                    top: _obj.top - $me.height() - $('#hovertip').height() - 3
                }).find('.arrow').addClass('arrowBottom').attr({
                    'style': 'width:' + me.sets.width + 'px;background-position:' + (me.sets.width / 2 + me.sets.arrLeft - 30) + 'px -30px;'
                })
            }
        }
    },
    function() {
        $('#hovertip').hover(function() {
            me.sets.hover = false
        },
        function() {
            $(this).hide();
            me.sets.hover = true
        });
        if (me.sets.arrow != '') {
            setTimeout(function() {
                if (me.sets.hover) $('#hovertip').hide();
                me.sets.hover = true
            },
            200)
        }
    })
};
$.fn.texttip = function(options) {
    var me = $(this);
    if (!$('#texttip')[0]) $('body').prepend('<span id="texttip" class="texttip"><em class="arrow"></em></span>');
    function findTotalOffset(obj) {
        var ol = ot = 0;
        if (obj.offsetParent) {
            do {
                ol += obj.offsetLeft;
                ot += obj.offsetTop
            } while ( obj = obj . offsetParent )
        };
        return {
            left: ol,
            top: ot
        }
    };
    $(this).hover(function() {
        var _obj = findTotalOffset(this);
        $('#texttip').html('<em class="arrow"></em>' + options.html).css({
            top: (_obj.top + me.height() + 4),
            left: (_obj.left + me.width() / 2 - $('#texttip').width() / 2) - 8
        }).show();
        $('#texttip .arrow').css({
            left: $('#texttip').width() / 2 + 3
        })
    },
    function() {
        $('#texttip').hide()
    })
};
$.fn.slide = function(settings) {
    return this.each(function() {
        $.extend(this, {
            defertime: 7000,
            btnopacity: 0.9,
            showbutton: true,
            fadingtime: 800
        },
        settings);
        var _c = this,
        index = 0,
        timer, slides = _c.slides ? _c.slides: $(_c).find('img').size();
        $(_c).find('.clip-image').children('a').css({
            zIndex: slides,
            display: 'none'
        });
        $(_c).hover(function() {
            clearInterval(timer)
        },
        function() {
            timer = setInterval(function() {
                sliding(++index % slides)
            },
            _c.defertime)
        }).trigger("mouseleave");
        function sliding(n) {
            $(_c).find("img").stop().animate({
                opacity: 0
            },
            _c.fadingtime).css('z-index', '').end().find("img").eq(n).stop().css('z-index', slides).animate({
                opacity: 1
            },
            _c.fadingtime);
            $(_c).find('.clip-image').children('a').hide();
            $(_c).find("img").eq(n).parent('.clip-image').children('a').show();
            $(_c).find("li").css({
                'color': '#B3B3B3',
                'background': '#fff',
                'font-weight': 'normal'
            }).eq(n).css({
                'color': '#fff',
                'background': '#c5c5c3',
                'font-weight': 'bold'
            })
        };
        var btnstr = '<ul style="position:absolute;z-index:' + (slides + 1) + ';right:3px;bottom:3px;">';
        for (var i = 0; i < slides; i++) {
            btnstr += '<li style="float:left;color:#B3B3B3;text-align:center;line-height:18px;width:28px;height:18px;font-size:12px;cursor:pointer;overflow: hidden;margin:0px 1px;border:1px solid #F3F3F3;background:#fff;">' + (i + 1) + '</li>'
        };
        btnstr += '</ul>';
        if (_c.showbutton) $(_c).append(btnstr);
        $(_c).find("img").css({
            'opacity': 0,
            'position': 'absolute',
            'top': '0',
            'left': '0'
        }).eq(0).css({
            'z-index': 1,
            'opacity': 1
        });
        $(_c).find("li").hover(function() {
            $(this).css({
                'color': '#fff',
                'background': '#c5c5c3',
                'font-weight': 'bold'
            })
        },
        function() {
            if ($(_c).find("li").index(this) !== index) $(_c).find("li").eq($(_c).find("li").index(this)).css({
                'color': '#B3B3B3',
                'background': '#fff',
                'font-weight': 'normal'
            })
        }).click(function() {
            index = $(_c).find("li").index(this);
            sliding(index);
            $(this).css({
                'color': '#fff',
                'background': '#c5c5c3',
                'font-weight': 'bold'
            })
        }).fadeTo("fast", _c.btnopacity).eq(0).css({
            'color': '#fff',
            'background': '#c5c5c3',
            'font-weight': 'bold'
        })
    })
};
$.fn.slide_litb = function(settings) {
    return this.each(function() {
        $.extend(this, {
            defertime: 7000,
            btnopacity: 0.9,
            showbutton: true,
            fadingtime: 800
        },
        settings);
        var _c = this,
        index = 0,
        timer, slides = _c.slides ? _c.slides: $(_c).find('img').size();
        $(_c).find('.clip-image').children('a').css({
            zIndex: slides,
            display: 'none'
        });
        $(_c).hover(function() {
            clearInterval(timer)
        },
        function() {
            timer = setInterval(function() {
                sliding(++index % slides)
            },
            _c.defertime)
        }).trigger("mouseleave");
        function sliding(n) {
            $(_c).find("img").stop().animate({
                opacity: 0
            },
            _c.fadingtime).css('z-index', '').end().find("img").eq(n).stop().css('z-index', slides).animate({
                opacity: 1
            },
            _c.fadingtime);
            $(_c).find('.clip-image').children('a').hide();
            $(_c).find("img").eq(n).parent('.clip-image').children('a').show();
            $(_c).find("li").removeClass('on').eq(n).addClass('on')
        };
        var btnstr = '<ul id="slidesThumb">';
        for (var i = 0; i < slides; i++) {
            btnstr += '<li></li>'
        };
        btnstr += '</ul>';
        if (_c.showbutton) {
            $(_c).append(btnstr);
            $('#slidesThumb').css('width', 24 * slides)
        }
        $(_c).find("img").css({
            'opacity': 0,
            'position': 'absolute',
            'top': '0',
            'left': '0'
        }).eq(0).css({
            'z-index': 1,
            'opacity': 1
        });
        $(_c).find("li").click(function() {
            index = $(_c).find("li").index(this);
            sliding(index)
        }).eq(0).addClass('on')
    })
};
$.fn.discountCountDown = function(options) {
    var pos = {
        'en': {
            all: [58, 82],
            days: [29, 85],
            none: 0,
            priceX: 0
        },
        'ar': {
            all: [58, 82],
            days: [29, 85],
            none: 0,
            priceX: 0
        },
        'fr': {
            all: [164, 120],
            days: [135, 120],
            none: 107,
            priceX: 0
        },
        'es': {
            all: [271, 130],
            days: [242, 132],
            none: 214,
            priceX: 0
        },
        'de': {
            all: [380, 113],
            days: [350, 115],
            none: 321,
            priceX: 0
        },
        'it': {
            all: [492, 115],
            days: [461, 144],
            none: 431,
            priceX: 0
        },
        'pt': {
            all: [602, 182],
            days: [571, 182],
            none: 541,
            priceX: 0
        },
        'ja': {
            all: [700, 145],
            days: [671, 145],
            none: 642,
            priceX: 0
        },
        'ru': {
            all: [801, 80],
            days: [772, 136],
            none: 743,
            priceX: 22
        },
        'nl': {
            all: [903, 98],
            days: [873, 133],
            none: 843,
            priceX: 0
        },
        'no': {
            all: [164, 120],
            days: [135, 120],
            none: 1077,
            priceX: 0
        },
        'da': {
            all: [164, 120],
            days: [135, 120],
            none: 1047,
            priceX: 0
        },
        'sv': {
            all: [164, 120],
            days: [135, 120],
            none: 1107,
            priceX: 0
        },
        'ko': {
            all: [164, 120],
            days: [135, 120],
            none: 1167,
            priceX: 0
        },
        'hi': {
            all: [164, 120],
            days: [135, 120],
            none: 107,
            priceX: 0
        },
        'fi': {
            all: [164, 120],
            days: [135, 120],
            none: 1137,
            priceX: 0
        },
        'he': {
            all: [164, 120],
            days: [135, 120],
            none: 1197,
            priceX: 33
        },
        'po': {
            all: [164, 120],
            days: [135, 120],
            none: 1230,
            priceX: 0
        },
        'zh': {
            all: [1008, 126],
            days: [980, 132],
            none: 952,
            priceX: 0
        },
        'tr': {
            all: [58, 82],
            days: [29, 85],
            none: 1310,
            priceX: 6
        },
        'pl': {
            all: [58, 82],
            days: [29, 85],
            none: 1270,
            priceX: 0
        },
        'cz': {
            all: [58, 82],
            days: [29, 85],
            none: 1350,
            priceX: 47
        },
        'ro': {
            all: [58, 82],
            days: [29, 85],
            none: 1390,
            priceX: 0
        },
        'hu': {
            all: [58, 82],
            days: [29, 85],
            none: 1430,
            priceX: 0
        },
        'gr': {
            all: [58, 82],
            days: [29, 85],
            none: 1470,
            priceX: 0
        },
        'hr': {
            all: [58, 82],
            days: [29, 85],
            none: 1510,
            priceX: 0
        },
        'ms': {
            all: [58, 82],
            days: [29, 85],
            none: 1550,
            priceX: 0
        },
        'id': {
            all: [58, 82],
            days: [29, 85],
            none: 1590,
            priceX: 0
        },
        'th': {
            all: [58, 82],
            days: [29, 85],
            none: 1630,
            priceX: 0
        }
    };
    var defaults = {
        price: '50',
        lang: 'en',
        noneDays: 10,
        onlyDays: 3
    };
    return this.each(function() {
        options = $.extend(defaults, options);
        if (!options.endDate) return;
        var el = $(this);
        var timeLeft = new Date(options.endDate) - new Date(litb.curDate);
        if (timeLeft <= 0) {
            return
        };
        el.css({
            position: 'relative',
            width: '257px',
            height: '20px',
            paddingTop: '3px',
            'line-height': '20px',
            marginBottom: '2px',
            background: 'url(' + litb.resouceURL + 'base-images/count-down-bg.png) 0 -826px no-repeat'
        }).html('<div style="position:absolute; padding-left:2px; width:200px; color:#fff; height:20px; line-height:20px; font-size:12px; font-family: Verdana, Geneva, sans-serif; font-weight:bold; font-style:italic;"></div><div style="position:absolute; width:25px; height:20px; color:#fff; line-height:18px; font-size:18px; font-family: Georgia, \'Times New Roman\', Times, serif; text-align:right; left:' + pos[options.lang].priceX + 'px;">' + options.price + '</div>');
        var timer, eltxt = $(el.children('div')[0]);
        var tick = function() {
            timeLeft -= 1000;
            if (timeLeft < 0) {
                window.clearInterval(timer);
                return
            };
            var seconds = timeLeft / 1000,
            minutes = Math.floor(seconds / 60),
            hours = Math.floor(minutes / 60),
            days = Math.floor(hours / 24);
            seconds %= 60;
            minutes %= 60;
            seconds = ("0" + seconds).slice( - 2);
            minutes = ("0" + minutes).slice( - 2);
            hours = ("0" + hours).slice( - 2);
            if (days >= options.noneDays) {
                el.css({
                    'width': 'auto',
                    'backgroundPosition': '0 -' + pos[options.lang].none + 'px'
                })
            } else if (days >= options.onlyDays) {
                el.css('backgroundPosition', '0 -' + pos[options.lang].days[0] + 'px');
                eltxt.css('left', pos[options.lang].days[1] + 'px').text(days)
            } else {
                el.css('backgroundPosition', '0 -' + pos[options.lang].all[0] + 'px');
                eltxt.css({
                    fontWeight: 'normal',
                    left: pos[options.lang].all[1] + 'px'
                }).text(hours + ':' + minutes + ":" + seconds)
            }
        };
        tick();
        timer = window.setInterval(tick, 1000)
    })
};
$.fn.groupDiscountFlip = function() {
    var el = $(this);
    var endTime = el.attr('endtime').replace(/\-/g, "/");
    if (!endTime) return;
    var now = new Date(endTime) - new Date(litb.curDate);
    if (now < 24 * 60 * 60 * 1000) {
        var child = window.document.getElementById("group_timeLabels");
        var remove = window.document.getElementById("group_dayLabel");
        child.removeChild(remove)
    }
    if (now <= 0) {
        return
    }
    new flipCounter('groupDiscountDown', {
        value: now / 1000,
        inc: 1,
        pace: 1000,
        auto: true,
        tFH: 30,
        bFH: 30,
        fW: 30,
        fWD: 30,
        bOffset: 300,
        wOffset: 0,
        day_0n: true,
        day_0: false
    })
};
$.fn.topFlipCounter = function() {
    var el = $(this);
    var endTime = el.attr('endtime').replace(/\-/g, "/");
    if (!endTime) return;
    el.html('');
    el.attr('id', randomID());
    var now = new Date(endTime) - new Date(litb.curDate);
    if (now <= 0) {
        return
    }
    var myCounter = new flipCounter(el.attr('id'), {
        value: now / 1000,
        inc: 1,
        pace: 1000,
        auto: true
    });
    el.parent().show()
};
var flipCounter = function(d, options) {
    var defaults = {
        value: 0,
        inc: 1,
        pace: 1000,
        auto: true,
        tFH: 28,
        bFH: 28,
        fW: 23,
        fWD: 23,
        bOffset: 283,
        wOffset: 100,
        day_0n: false,
        day_0: true
    };
    var o = options || {},
    doc = window.document,
    divId = typeof d !== 'undefined' && d !== '' ? d: 'flip-counter',
    div = doc.getElementById(divId);
    for (var opt in defaults) o[opt] = (opt in o) ? o[opt] : defaults[opt];
    var digitsOld = [],
    digitsNew = [],
    subStart,
    subEnd,
    x,
    y,
    nextCount = null,
    newDigit,
    newComma,
    best = {
        q: null,
        pace: 0,
        inc: 0
    };
    function doCount() {
        if ((y = o.value) == 0) return;
        var day = (Math.floor(y / 86400));
        var hrs = (Math.floor(y / 3600)) % 24;
        var min = (Math.floor(y / 60)) % 60;
        var sec = (Math.floor(y / 1)) % 60;
        hrs = ("0" + hrs).slice( - 2);
        min = ("0" + min).slice( - 2);
        sec = ("0" + sec).slice( - 2);
        var seconds = day + hrs + min + sec;
        x = Number(seconds);
        o.value -= o.inc;
        y = o.value;
        day = (Math.floor(y / 86400));
        hrs = (Math.floor(y / 3600)) % 24;
        min = (Math.floor(y / 60)) % 60;
        sec = (Math.floor(y / 1)) % 60;
        hrs = ("0" + hrs).slice( - 2);
        min = ("0" + min).slice( - 2);
        sec = ("0" + sec).slice( - 2);
        seconds = day + hrs + min + sec;
        y = Number(seconds);
        digitCheck(x, y);
        if (o.auto === true) nextCount = setTimeout(doCount, o.pace)
    }
    function digitCheck(x, y) {
        digitsOld = splitToArray(x);
        digitsNew = splitToArray(y);
        var diff, xlen = digitsOld.length,
        ylen = digitsNew.length;
        if (ylen < xlen) {
            diff = xlen - ylen;
            if (diff > 0 && ylen > 6) {
                if (o.day_0n && ylen == 7) {
                    digitsNew[xlen - diff] = 0
                } else {
                    removeDigit(xlen - diff);
                    xlen--
                }
            } else if (!o.day_0 && ylen == 6) {
                removeDigit(xlen - diff);
                removeDigit(xlen - diff + 1);
                removeDayLabel();
                xlen--
            } else {
                digitsNew[xlen - diff] = 0
            }
        }
        for (var i = 0; i < xlen; i++) {
            if (digitsNew[i] != digitsOld[i]) {
                animateDigit(i, digitsOld[i], digitsNew[i])
            }
        }
        if (i == 7 && digitsNew[i - 1] == 1) {
            var second = div.childNodes[1].childNodes[0].innerText;
            if (second == 'DAYS') {
                div.childNodes[1].childNodes[0].innerText = 'DAY'
            }
        }
    }
    function animateDigit(n, oldDigit, newDigit) {
        var speed, step = 0,
        w, a, bp = ['-' + o.fW + 'px -' + (oldDigit * o.tFH) + 'px', (o.fW * -2) + 'px -' + (oldDigit * o.tFH) + 'px', '0 -' + (newDigit * o.tFH) + 'px', '-' + o.fW + 'px -' + (oldDigit * o.bFH + o.bOffset) + 'px', (o.fW * -2) + 'px -' + (newDigit * o.bFH + o.bOffset) + 'px', (o.fW * -3) + 'px -' + (newDigit * o.bFH + o.bOffset) + 'px', '0 -' + (newDigit * o.bFH + o.bOffset) + 'px'],
        bp_day = ['-' + (o.wOffset + o.fWD) + 'px -' + (oldDigit * o.tFH) + 'px', ( - o.wOffset + o.fWD * -2) + 'px -' + (oldDigit * o.tFH) + 'px', '-' + o.wOffset + 'px -' + (newDigit * o.tFH) + 'px', '-' + (o.wOffset + o.fWD) + 'px -' + (oldDigit * o.bFH + o.bOffset) + 'px', ( - o.wOffset + o.fWD * -2) + 'px -' + (newDigit * o.bFH + o.bOffset) + 'px', ( - o.wOffset + o.fWD * -3) + 'px -' + (newDigit * o.bFH + o.bOffset) + 'px', '-' + o.wOffset + 'px -' + (newDigit * o.bFH + o.bOffset) + 'px'];
        speed = 80;
        function animate() {
            if (step < 7) {
                w = step < 3 ? 't': 'b';
                a = doc.getElementById(divId + "_" + w + "_d" + n);
                if (a) {
                    if (n < 6) a.style.backgroundPosition = bp[step];
                    else a.style.backgroundPosition = bp_day[step]
                }
                step++;
                if (step != 3) setTimeout(animate, speed);
                else animate()
            }
        }
        animate()
    }
    function splitToArray(input) {
        return input.toString().split("").reverse()
    }
    function removeDigit(id) {
        var remove = doc.getElementById(divId + "_d" + id);
        div.removeChild(remove)
    }
    function removeDayLabel() {
        var child = doc.getElementById("group_timeLabels");
        var remove = doc.getElementById("group_dayLabel");
        child.removeChild(remove)
    }
    function initialDigitCheck(init) {
        var day = (Math.floor(init / 86400));
        var hrs = (Math.floor(init / 3600)) % 24;
        var min = (Math.floor(init / 60)) % 60;
        var sec = (Math.floor(init / 1)) % 60;
        if (day < 10 && day >= 0 && o.day_0n) {
            day = ("0" + day).slice( - 2)
        }
        if (day == 0 && !o.day_0) {
            day = ""
        }
        hrs = ("0" + hrs).slice( - 2);
        min = ("0" + min).slice( - 2);
        sec = ("0" + sec).slice( - 2);
        var initial = day + hrs + min + sec;
        var count = initial.length,
        bit = 1,
        i;
        if (count == 6 && o.day_0) count = 7;
        if (count == 7) {
            count = o.day_0n ? 8 : 7
        }
        for (i = 0; i < count; i++) {
            newDigit = doc.createElement("ul");
            newDigit.className = 'cd';
            newDigit.id = divId + '_d' + i;
            if (i > 5) {
                newDigit.innerHTML = '<li class="day_t" id="' + divId + '_t_d' + i + '"></li><li class="day_b" id="' + divId + '_b_d' + i + '"></li>'
            } else {
                newDigit.innerHTML = '<li class="t" id="' + divId + '_t_d' + i + '"></li><li class="b" id="' + divId + '_b_d' + i + '"></li>'
            }
            div.insertBefore(newDigit, div.firstChild);
            if (bit != (count) && bit % 2 == 0 && bit < 7) {
                newComma = doc.createElement("ul");
                newComma.className = 'cd';
                if (bit % 6 == 0) {
                    if (day <= 1) {
                        newComma.innerHTML = '<li class="days">' + litb.langs.countdown.day + '</li>'
                    } else {
                        newComma.innerHTML = '<li class="days">' + litb.langs.countdown.days + '</li>'
                    }
                } else {
                    newComma.innerHTML = '<li class="s"></li>'
                }
                div.insertBefore(newComma, div.firstChild)
            }
            bit++
        }
        var digits = splitToArray(initial);
        if (initial.length < count) {
            var diff = count - initial.length;
            while (diff) {
                digits[count - diff] = 0;
                diff--
            }
        }
        for (i = 0; i < count; i++) {
            if (i < 6) {
                doc.getElementById(divId + "_t_d" + i).style.backgroundPosition = '0 -' + (digits[i] * o.tFH) + 'px';
                doc.getElementById(divId + "_b_d" + i).style.backgroundPosition = '0 -' + (digits[i] * o.bFH + o.bOffset) + 'px'
            } else {
                doc.getElementById(divId + "_t_d" + i).style.backgroundPosition = '-' + o.wOffset + 'px -' + (digits[i] * o.tFH) + 'px';
                doc.getElementById(divId + "_b_d" + i).style.backgroundPosition = '-' + o.wOffset + 'px -' + (digits[i] * o.bFH + o.bOffset) + 'px'
            }
        }
        if (o.auto === true) nextCount = setTimeout(doCount, o.pace)
    }
    initialDigitCheck(o.value)
};
$.fn.topSlimeBanner = function() {
    var el = $(this);
    var endTime = el.attr('endtime').replace(/\-/g, "/");
    if (!endTime) return;
    el.html('');
    var now = new Date(endTime) - new Date(litb.curDate);
    if (now <= 0) {
        return
    }
    el.genTimer({
        beginTime: litb.curDate,
        day_label: litb.langs.countdown.day,
        days_label: litb.langs.countdown.days,
        targetTime: $(this).attr('endTime'),
        callback: function(time) {
            this.html(time)
        }
    });
    el.parent().show()
};
$.fn.genTimer = function(options) {
    if (this.data('handled')) {
        return this
    }
    this.data('handled', true);
    var defaults = {
        beginTime: (new Date()),
        day_label: litb.langs.discountCountDown.day,
        days_label: litb.langs.discountCountDown.days,
        unitWord: {
            hours: ":",
            minutes: ":",
            seconds: ""
        },
        type: 'day',
        callbackOnlyDatas: false
    };
    var DAY_MILLISECOND = 1000 * 60 * 60 * 24;
    var opts = $.extend({},
    defaults, options);
    var _this = this;
    var callback = function() {
        if (duration < 0) {
            opts.callback.call(_this, opts.callbackOnlyDatas ? {
                hours: '00',
                minutes: '00',
                seconds: '00',
                dates: 0
            }: "00" + opts.unitWord.hours + "00" + opts.unitWord.minutes + "00");
            clearInterval(_this.interval)
        } else {
            var viewDuration = calcView(duration);
            if (opts.callbackOnlyDatas) {
                opts.callback.call(_this, viewDuration)
            } else {
                if (opts.type == 'day') {
                    if (duration >= DAY_MILLISECOND * 2) {
                        opts.callback.call(_this, '<span class="day_count">' + viewDuration.dates + '</span><span class="day">' + opts.days_label + '</span><span class="day_seconds">' + viewDuration.hours + opts.unitWord.hours + viewDuration.minutes + opts.unitWord.minutes + viewDuration.seconds + opts.unitWord.seconds + '</span>')
                    } else if (duration >= DAY_MILLISECOND) {
                        opts.callback.call(_this, '<span class="day_count">' + viewDuration.dates + '</span><span class="day">' + opts.day_label + '</span><span class="day_seconds">' + viewDuration.hours + opts.unitWord.hours + viewDuration.minutes + opts.unitWord.minutes + viewDuration.seconds + opts.unitWord.seconds + '</span>')
                    } else {
                        opts.callback.call(_this, '<span class="seconds">' + viewDuration.hours + opts.unitWord.hours + viewDuration.minutes + opts.unitWord.minutes + viewDuration.seconds + opts.unitWord.seconds + '</span>')
                    }
                } else {
                    var hours = viewDuration.hours;
                    if (duration >= DAY_MILLISECOND) {
                        hours = Number((viewDuration.dates) * 24) + Number(viewDuration.hours)
                    }
                    opts.callback.call(_this, '<span class="seconds">' + hours + opts.unitWord.hours + viewDuration.minutes + opts.unitWord.minutes + viewDuration.seconds + opts.unitWord.seconds + '</span>')
                }
            }
        }
        duration -= 1000
    };
    _this.interval = setInterval(callback, 1000);
    opts.targetTime = opts.targetTime.replace(/\-/g, "/");
    var duration = new Date(opts.targetTime) - new Date(opts.beginTime);
    callback();
    function calcView(duration) {
        var dates = Math.floor(duration / DAY_MILLISECOND);
        var hours = Math.floor((duration - dates * DAY_MILLISECOND) / (1000 * 60 * 60));
        var minutes = Math.floor((duration - dates * DAY_MILLISECOND - hours * 1000 * 60 * 60) / (1000 * 60));
        var seconds = Math.floor((duration - dates * DAY_MILLISECOND - hours * 1000 * 60 * 60 - minutes * 1000 * 60) / 1000);
        return {
            hours: ('0' + hours).slice( - 2),
            minutes: ('0' + minutes).slice( - 2),
            seconds: ('0' + seconds).slice( - 2),
            dates: dates
        }
    }
    return this
};
$.fn.slideDfp = function() {
    return this.each(function() {
        var mc = $(this).children('div').show();
        var slides = mc.size(),
        index = 0,
        timer;
        if (slides < 1) return;
        $(mc).find("img").css({
            'position': 'absolute',
            'opacity': 0
        }).parent().hide();
        $(mc).find("img").eq(0).css({
            'z-index': slides,
            'opacity': 1
        }).parent().show();
        function sliding(n) {
            $(mc).find("img").stop().animate({
                opacity: 0
            },
            800,
            function() {
                $(this).parent().hide()
            }).css('z-index', '').end().find("img").eq(n).stop().parent().show().children('img').css('z-index', slides).animate({
                opacity: 1
            },
            800);
            $(mc).parent().children('img.dfp_dot').css('opacity', 0.5).eq(n).css('opacity', 1)
        };
        $(this).hover(function() {
            clearInterval(timer)
        },
        function() {
            timer = setInterval(function() {
                sliding(++index % slides)
            },
            7000)
        }).trigger("mouseleave");
        if ($(this).attr('class') !== 'slide_dfp_l') {
            $(this).append('<img title="' + litb.langs.pageBar.prev + '" style="left:0" src="' + litb.resouceURL + 'base-images/prev_arrow.png" /><img title="' + litb.langs.pageBar.next + '" src="' + litb.resouceURL + 'base-images/next_arrow.png" style="right:0" />');
            $(this).children('img').css({
                position: 'absolute',
                'z-index': 1000,
                top: ($(this).height() || parseInt($(this).css('height'))) / 2 - 10
            }).bind('click',
            function(event) { ($(event.target).attr('title') == litb.langs.pageBar.prev) ? index--:index++;
                index = (index + slides) % slides;
                sliding(index)
            })
        } else {
            $(this).append('<img title="' + litb.langs.pageBar.prev + '" style="right:' + (10 + 14 * (slides + 1)) + 'px;" src="' + litb.resouceURL + 'base-images/prev_arr.jpg" /><img title="' + litb.langs.pageBar.next + '" src="' + litb.resouceURL + 'base-images/next_arr.jpg" style="right:10px;" />');
            for (var i = 0; i < slides; i++) {
                $(this).append('<img class="dfp_dot" title="' + (i + 1) + '" style="right:' + (10 + 14 * (slides - i)) + 'px;" src="' + litb.resouceURL + 'base-images/dot.jpg" />')
            }
            $(this).children('img').css({
                position: 'absolute',
                cursor: 'pointer',
                bottom: '7px',
                'z-index': 1000
            }).bind('click',
            function(event) {
                if ($(event.target).attr('title') == litb.langs.pageBar.prev) {
                    index--
                } else if ($(event.target).attr('title') == litb.langs.pageBar.next) {
                    index++
                } else {
                    index = parseInt($(event.target).attr('title')) - 1
                }
                index = (index + slides) % slides;
                sliding(index)
            });
            $(this).children('img.dfp_dot').css('opacity', 0.5).eq(index).css('opacity', 1)
        }
    })
};
$.fn.coupletDfp = function() {
    $.extend({},
    {
        easing: {
            backout: function(x, t, b, c, d) {
                var s = 1.01158;
                return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b
            },
            linear: function(x, t, b, c, d) {
                return c * t / d + b
            }
        }
    });
    return this.each(function() {
        var _el = $(this),
        closed = false,
        t,
        t2,
        space = 1,
        offtop = 49,
        initWidth = 25,
        initHeight = 25 + Number(_el.find('img').css('height').replace('px', '')),
        isLeft = _el.attr('class') === 'dfp-couplet-left',
        scrollable = _el.attr('scroll') === 'true',
        maxwidth = Number(_el.find('img').css('width').replace('px', '')),
        w = $('#main').width(),
        h = $('#main').height();
        pos = $('#main').offset();
        var wrapper = $('<div></div>');
        var side = (isLeft) ? 'left': 'right';
        wrapper.appendTo('body').css({
            'z-index': 100000,
            'position': 'absolute',
            'top': h + pos.top + offtop
        }).css(side, 0);
        _el.appendTo(wrapper).show().css({
            'width': initWidth + 'px',
            'height': initHeight + 'px'
        });
        function toggleShow() {
            if (closed) return; ($(window).width() <= (2 * (space + _el.width())) + w) ? _el.hide() : _el.show()
        };
        function scroll() {
            if (closed) return;
            clearTimeout(t2);
            t2 = setTimeout(function() {
                wrapper.stop().animate({
                    top: $(window).scrollTop() + h + pos.top + offtop
                },
                1200, 'backout')
            },
            175)
        };
        toggleShow();
        $(window).bind('resize', toggleShow);
        if (scrollable) {
            scroll();
            $(window).bind('scroll', scroll)
        };
        _el.children('a').hover(function() {
            clearTimeout(t);
            t = setTimeout(function() {
                _el.stop().animate({
                    width: maxwidth
                },
                'slow')
            },
            150)
        },
        function() {
            clearTimeout(t);
            t = setTimeout(function() {
                if (!closed) _el.stop().animate({
                    width: initWidth
                },
                'slow')
            },
            1000)
        });
        _el.append('<img src="' + litb.resouceURL + 'base-images/close.jpg" style="position:absolute; z-index:100000; bottom:0; ' + (isLeft ? '': 'right:0;') + '" />');
        _el.children('img').bind('click',
        function() {
            _el.stop().hide();
            closed = true
        })
    })
};
$(function() {
    $(".slide_dfp_l").slideDfp();
    $(".slide_dfp_s").slideDfp();
    $(".count_down").each(function() {
        var $me = $(this),
        img = new Image();
        img.onload = function() {
            $me.topFlipCounter()
        };
        img.src = $(this).parent().find('img').attr('src')
    });
    $('.discount_timer').each(function() {
        var $me = $(this),
        img = new Image();
        img.onload = function() {
            $me.topSlimeBanner()
        };
        img.src = $(this).parent().find('img').attr('src')
    });
    $(".dfp-couplet-left").coupletDfp();
    $(".dfp-couplet-right").coupletDfp();
    $("img").each(function() {
        for (var i = 0; i < litb.imagesURL.length; i++) {
            var sp = litb.imagesURL[i];
            var path = sp.replace('images/', ''),
            rectPath = new RegExp(path + "(" + litb.siteWater + ")\?(extra_)?images/[ab]"),
            patt = new RegExp(path + "(" + litb.siteWater + ")\?(extra_)?images/[spmflvab]");
            var el = this;
            var src = $(el).attr('src');
            if (patt.test(src)) {
                var imgPreloader = new Image();
                imgPreloader.onerror = function() { (rectPath.test(src)) ? $(el).attr('src', litb.resouceURL + 'base-images/185x300.png') : $(el).attr('src', litb.resouceURL + 'base-images/300x300.png')
                };
                imgPreloader.src = src
            }
        }
    });
    $(".use_round_border").each(function() {
        $(this).html('<em><b></b></em><div class="use_round_border_con">' + $(this).html() + '</div><b><em></em></b>')
    });
    $(".attr_table_1 tr").find('td:first:not([class])').css('backgroundColor', '#E1F1F6').width(100);
    $.each({
        'attr_table_gray': 'lit_gray_bg',
        'attr_table_yellow': 'yellow_bg'
    },
    function(tableClass, bgClass) {
        $('.' + tableClass).each(function() {
            var r = 0,
            subTitle = false;
            $('tr', this).each(function(n) {
                firstRow = false;
                $('td', this).each(function(m) {
                    if (m == 0) {
                        if (n == 0) {
                            $(this).addClass('lit_pink_bg b');
                            r += $(this).attr('rowSpan')
                        } else if (r > n) {
                            subTitle = true;
                            $(this).addClass('lit_lightpink_bg b')
                        } else if ($(this).attr('class') == '' && r == n) {
                            subTitle = false;
                            firstRow = true;
                            $(this).addClass(bgClass + ' b');
                            r += $(this).attr('rowSpan')
                        }
                    } else {
                        if (n == 0) {
                            $(this).addClass('lit_pink_bg b')
                        } else if (subTitle) {
                            $(this).addClass('lit_lightpink_bg b')
                        } else if ($(this).attr('colSpan') == 1 && m % 2 == (firstRow ? 0 : 1)) $(this).addClass(bgClass)
                    }
                })
            })
        })
    });
    $('.table_all').each(function() {
        if ($(this).attr('class').search('attr_table') > -1) return;
        $me = $(this),
        r = 0,
        independentRow = 0;
        $('tr', this).each(function(n) {
            if (r <= n) {
                r += $('td:first', this).attr('rowSpan');
                independentRow = 1
            }
            if ($(this).attr('class')) return;
            $('td', this).each(function(m) {
                if ($me.hasClass('left_header') && m == 0 && independentRow) $(this).addClass('table_header_bg b');
                else if (m % 2 != independentRow) $(this).addClass('gray_column_bg')
            });
            independentRow = 0
        })
    });
    $(".standard-table tr").each(function() {
        $(this).find("td").eq(0).addClass("title")
    })
});
function zoomPrImage() {
    var li1 = "li_img01",
    li2 = "li_img02";
    var viewportWidth = 380,
    viewportHeight = 500,
    tileSize = 250;
    var imageBaseName, imageDatePath;
    var zoom = 0;
    var zoomPath = ["s", "m", "l"];
    var zoomSizes = [["500px", "500px"], ["1000px", "1000px"], ["1500px", "1500px"]];
    var scaleMode = "out";
    var dragging = false;
    var pDragging = false;
    var is1500 = true;
    var offTop = 0,
    offLeft = 0;
    var oT, oL, dragStartTop, dragStartLeft, dragST, dragSL;
    function init() {
        imageDatePath = getRegExp($("#zoomBg")[0].src, 0);
        imageBaseName = getRegExp($("#zoomBg")[0].src, 1);
        setInnerDivSize(zoomSizes[zoom][0], zoomSizes[zoom][1]);
        $("#featuredImg").bind("mousedown", startMove);
        $("#featuredImg").bind("mousemove", processMove);
        $("#featuredImg").bind("mouseup", stopMove);
        $("#featuredImg").bind("dblclick", scaleMove);
        $("#navigator").bind("mousedown", pStartMove);
        $("#navigator").bind("mousemove", pProcessMove);
        $("#navigator").fadeTo("slow", 0.6);
        document.getElementById("featuredImg").ondragstart = function() {
            return false
        };
        document.getElementById("navigator").ondragstart = function() {
            return false
        };
        checkTiles();
        initList();
        if (initBigImg == 0) {
            var isrc = $(".navControl img")[0].src;
            $("#zoomBg").attr({
                src: litb.imageURL + litb.siteWater + "images/v/" + getRegExp(isrc, 0) + "/" + getRegExp(isrc, 1) + ".jpg"
            }).siblings().hide();
            is1500 = false
        };
        $('.zoomOut').click(function() {
            goZoom('in');
            return false
        });
        $('.zoomIn').click(function() {
            goZoom('out');
            return false
        });
        $('.zoomReset').click(function() {
            goZoom('reset');
            return false
        })
    };
    function getRegExp(str, exp) {
        var regExps = exp == 1 ? /\/s\/[0-9]*\/([A-Za-z0-9]*)/: /\/s\/([0-9]*)/;
        regExps.exec(str);
        return RegExp.$1
    };
    function initList() {
        var c = $(".zoomList img").hasClass(li1);
        $(".zoomList img").each(function() {
            $(this).click(function() {
                $(this).removeClass(li2).addClass(li1);
                $(c).removeClass(li1).addClass(li2);
                c = $(this);
                sr = $(this).attr("src");
                $(".navControl img").attr({
                    src: sr
                });
                if ($(this).attr("bimg") == 0) {
                    $("#zoomBg").attr({
                        src: litb.imageURL + litb.siteWater + "images/v/" + getRegExp(sr, 0) + "/" + getRegExp(sr, 1) + ".jpg"
                    }).siblings().hide();
                    is1500 = false
                } else {
                    $("#zoomBg").attr({
                        src: sr
                    });
                    imageDatePath = getRegExp($("#zoomBg")[0].src, 0);
                    imageBaseName = getRegExp($("#zoomBg")[0].src, 1);
                    is1500 = true
                };
                goZoom('reset');
                return false
            });
            if ($(this).hasClass(li1)) c = $(this);
            $(this).hover(function() {
                $(this).removeClass(li2).addClass(li1)
            },
            function() {
                if ($(this).get(0) != $(c).get(0)) $(this).removeClass(li1).addClass(li2)
            })
        })
    };
    function limitArea(x, y) {
        if (y > 0) y = 0;
        if (y < -(zoom * viewportHeight)) y = -(zoom * viewportHeight);
        if (x > -((zoom + 1) * 60)) x = -((zoom + 1) * 60);
        if (x < (viewportWidth - (zoom + 1) * 440)) x = (viewportWidth - (zoom + 1) * 440);
        return {
            x: x,
            y: y
        }
    };
    function scaleMove(e) {
        if (zoom == 2) return;
        if (e.target.tagName == "A") return;
        var cursorOffX = e.clientX - $("#featuredImg").offsetLeft - stripPx($(".imgHolder").css("left"));
        var cursorOffY = e.clientY - $("#featuredImg").offsetTop - stripPx($(".imgHolder").css("top"));
        toggleZoom(cursorOffX, cursorOffY, "out")
    };
    function startMove(e) {
        if (zoom == 0) return;
        if (e.target.tagName == "DIV") return;
        dragStartLeft = e.clientX;
        dragStartTop = e.clientY;
        offTop = stripPx($(".imgHolder").css("top"));
        offLeft = stripPx($(".imgHolder").css("left"));
        dragging = true;
        return false
    };
    function processMove(e) {
        if (zoom == 0) return;
        if (e.target.tagName == "DIV") return;
        var innerDiv = $(".imgHolder");
        if (dragging) {
            var moveX = offLeft + (e.clientX - dragStartLeft);
            var moveY = offTop + (e.clientY - dragStartTop);
            var offset = limitArea(moveX, moveY);
            innerDiv.css({
                left: offset.x,
                top: offset.y
            })
        };
        updatePointer()
    };
    function checkTiles() {
        var visibleTiles = getVisibleTiles();
        var innerDiv = $(".imgHolder");
        var visibleTilesMap = {};
        if (!is1500) return;
        for (i = 0; i < visibleTiles.length; i++) {
            var tileArray = visibleTiles[i];
            var tileName = imageBaseName + "_" + tileArray[0] + "_" + tileArray[1];
            visibleTilesMap[tileName] = true;
            var img = document.getElementById(tileName + "_" + zoom);
            if (!img) {
                img = document.createElement("img");
                img.src = litb.imageURL + litb.siteWater + "extra_images/" + zoomPath[zoom] + "/" + imageDatePath + "/" + tileName + ".jpg";
                img.style.position = "absolute";
                img.style.left = tileArray[0] + "px";
                img.style.top = tileArray[1] + "px";
                img.style.width = tileSize + 0.5 + "px";
                img.style.zIndex = 1;
                img.setAttribute("id", tileName + "_" + zoom);
                innerDiv.append(img)
            }
        }
    };
    function getVisibleTiles() {
        var innerDiv = $(".imgHolder");
        var mapX = stripPx(innerDiv.css('left'));
        var mapY = stripPx(innerDiv.css('top'));
        var startX = Math.abs(Math.floor(mapX / tileSize)) - 1;
        var startY = Math.abs(Math.floor(mapY / tileSize)) - 1;
        var tilesX = Math.ceil(viewportWidth / tileSize) + 1;
        var tilesY = Math.ceil(viewportHeight / tileSize) + 1;
        var visibleTileArray = [];
        var counter = 0;
        for (x = startX; x < (tilesX + startX); x++) {
            for (y = startY; y < (tilesY + startY); y++) {
                var x1 = x * tileSize;
                var y1 = y * tileSize;
                if (x1 < 0 || y1 < 0) continue;
                switch (zoom) {
                case 0:
                    if (x1 > 250 || y1 > 250) continue;
                    break;
                case 1:
                    if (x1 > 750 || y1 > 750) continue;
                    break;
                case 2:
                    if (x1 > 1250 || y1 > 1250) continue;
                    break
                };
                visibleTileArray[counter++] = [x1, y1]
            }
        };
        return visibleTileArray
    };
    function stopMove(e) {
        if (zoom == 0) return;
        dragging = false;
        pDragging = false;
        checkTiles()
    };
    function pStartMove(e) {
        if (zoom == 0) return;
        dragSL = e.clientX;
        dragST = e.clientY;
        var pointer = $("#navigator");
        oT = stripPx(pointer.css("top"));
        oL = stripPx(pointer.css("left"));
        pDragging = true;
        return false
    };
    function pProcessMove(e) {
        if (zoom == 0) return;
        var pointer = $("#navigator");
        if (pDragging) {
            var moveX = oL + (e.clientX - dragSL);
            var moveY = oT + (e.clientY - dragST);
            if (moveX < 6) moveX = 6;
            if (moveY < 0) moveY = 0;
            if (moveY > 50 - pointer.height()) moveY = 50 - pointer.height();
            if (moveX > 44 - pointer.width()) moveX = 44 - pointer.width();
            pointer.css({
                left: moveX,
                top: moveY
            });
            var ox = -stripPx(pointer.css("left")) * (zoom + 1) * 10;
            var oy = -stripPx(pointer.css("top")) * (zoom + 1) * 10;
            var offset = limitArea(ox, oy);
            ox = offset.x;
            oy = offset.y;
            $(".imgHolder").css({
                width: 500 * (zoom + 1),
                height: 500 * (zoom + 1),
                left: ox,
                top: oy
            })
        }
    };
    function stripPx(value) {
        if (value == "") return 0;
        return parseFloat(value.replace(/px/i, ''))
    };
    function setInnerDivSize(width, height, x, y) {
        var innerDiv = $(".imgHolder");
        innerDiv.css({
            width: width,
            height: height
        });
        var moveX;
        var moveY;
        if (x && y && scaleMode == "out") {
            moveX = offLeft - x / zoom;
            if (zoom == 1) {
                moveX = offLeft - x / zoom - 60 * (zoom + 1)
            };
            moveY = offTop - y / zoom
        };
        if (scaleMode == "in") {
            offLeft = (zoom == 0) ? 0 : stripPx(innerDiv.css("left"));
            offTop = (zoom == 0) ? 0 : stripPx(innerDiv.css("top"));
            moveX = offLeft / (zoom + 1);
            moveY = offTop / (zoom + 1)
        };
        if (scaleMode == "reset") {
            moveX = -60;
            moveY = 0;
            offLeft = offTop = 0
        };
        var offset = limitArea(moveX, moveY);
        innerDiv.css({
            left: offset.x,
            top: offset.y
        });
        updatePointer()
    };
    function updatePointer() {
        var el = $("#navigator");
        var l = $(".imgHolder").css('left'),
        t = $(".imgHolder").css('top');
        var ox = -stripPx(l) / [(zoom + 1) * 10];
        var oy = -stripPx(t) / [(zoom + 1) * 10]; (zoom == 0) ? el.css("cursor", "") : el.css("cursor", "move");
        el.css({
            width: 38 / (zoom + 1),
            height: 50 / (zoom + 1),
            left: ox,
            top: oy
        })
    };
    function goZoom(type) {
        toggleZoom("", "", type)
    };
    function toggleZoom(clickX, clickY, type) {
        scaleMode = type;
        switch (type) {
        case "out":
            zoom++;
            if (zoom > 2) {
                zoom = 2;
                return
            };
            break;
        case "in":
            zoom--;
            if (zoom < 0) {
                zoom = 0;
                return
            };
            break;
        case "reset":
            zoom = 0;
            break
        };
        var innerDiv = $(".imgHolder");
        var posX;
        var posY;
        posX = (clickX) ? clickX: (viewportWidth / 2 - offLeft);
        posY = (clickY) ? clickY: (viewportHeight / 2 - offTop);
        $("#zoomBg").width(zoomSizes[zoom][0]);
        $("#zoomBg").height(zoomSizes[zoom][1]);
        setInnerDivSize(zoomSizes[zoom][0], zoomSizes[zoom][1], posX, posY);
        var imgs = innerDiv.find("img");
        for (var i = imgs.size() - 1; i > 0; i--) {
            $(imgs[i]).remove()
        }; (clickX) ? checkTiles() : setTimeout(checkTiles, 500)
    };
    var initBigImg = 1;
    init()
};
$.fn.mask = function(params) {
    params = $.extend({
        maskOpacity: 0.5,
        maskBgcolor: '#ccc'
    },
    params);
    $(this).each(function() {
        if ($(this).hasClass('masked')) return;
        var element = $(this);
        if (element.css("position") == "static") {
            element.addClass("masked-relative")
        }
        var maskDiv = $('<div class="loadmask"></div>').css({
            'opacity': params.maskOpacity,
            'backgroundColor': params.maskBgcolor
        });
        if (!params.width && !params.height) {
            if ($.browser.msie) {
                maskDiv.height(element.height() + parseInt(element.css("padding-top")) + parseInt(element.css("padding-bottom")));
                maskDiv.width(element.width() + parseInt(element.css("padding-left")) + parseInt(element.css("padding-right")));
                if ($.browser.version < 7) element.find("select").addClass("masked-hidden")
            }
        } else {
            if (params.width) {
                maskDiv.width(params.width)
            };
            if (params.height) {
                maskDiv.height(params.height)
            }
        };
        element.addClass("masked").append(maskDiv);
        var maskMsg = params.text ? $('<div class="loadmask-msg withtext">' + params.text + '</div>') : $('<div class="loadmask-msg"></div>');
        maskMsg.appendTo(element).wrap('<div></div>');
        maskMsg.css({
            'top': maskDiv.height() / 2 - (maskMsg.height() + parseInt(maskMsg.css("padding-top")) + parseInt(maskMsg.css("padding-bottom"))) / 2,
            'left': maskDiv.width() / 2 - (maskMsg.width() + parseInt(maskMsg.css("padding-left")) + parseInt(maskMsg.css("padding-right"))) / 2
        })
    })
};
$.fn.unmask = function() {
    $(this).each(function() {
        var element = $(this);
        element.find(".loadmask-msg").parent().remove();
        element.find(".loadmask").remove();
        element.removeClass("masked masked-relative");
        element.find("select").removeClass("masked-hidden")
    })
};
$.fn.ProductsListShow = function(options) {
    var $me = $(this),
    me = this,
    loadedImages = {};
    this.sets = {
        show: 6,
        now: 0,
        type: 'alsolike',
        tra: 0,
        tracking: {}
    };
    if (options) {
        $.extend(me.sets, options)
    };
    function loadImg(images, loadCallback) {
        var imgs = new Array();
        for (var i = 0; i < images.length; i++) {
            imgs[i] = new Image();
            imgs[i].onload = function() {
                loadedImages[this.src] = true;
                for (var j = 0; j < images.length; j++) {
                    if (loadedImages[images[j]] == null) {
                        break
                    }
                }
                if (j == images.length) {
                    loadCallback()
                }
            };
            imgs[i].onerror = function() {
                loadedImages[this.src] = false;
                for (var j = 0; j < images.length; j++) {
                    if (loadedImages[images[j]] == null) {
                        break
                    }
                }
                if (j == images.length) {
                    loadCallback()
                }
            };
            imgs[i].src = images[i]
        }
    };
    this.init = function(cmplCallback) {
        var _list = me.sets.data,
        images = new Array();
        for (var i = me.sets.now * me.sets.show; i < (me.sets.now + 1) * me.sets.show; i++) {
            if (!_list[i]) break;
            if (loadedImages[_list[i]['image']] == null) {
                images.push(_list[i]['image'])
            }
        }
        cmplCallback()
    };
    this.set = function() {
        me.init(function() {
            var html = '',
            _list = me.sets.data;
            var _track = '';
            for (var i in me.sets.tracking) {
                if (typeof(i) == "string") {
                    _track += '\'' + i + '\':\'' + me.sets.tracking[i] + '\','
                }
            }
            _track = _track.substring(0, _track.length - 1);
            for (var i = me.sets.now * me.sets.show; i < (me.sets.now + 1) * me.sets.show; i++) {
                if (!_list[i]) break;
                var _i = i + 1;
                html += '<dl><dt><a class="ctrTrack" ';
                if (_track != '') {}
                var _ctr = 'ctr="{pos:\'' + _i + '\',type:\'P\',cpid:\'' + _list[i]["pid"] + '\'}" ';
                html += _ctr + ' entity="p_image" alt="' + _list[i]["title"] + '" title="' + _list[i]["title"] + '" href="' + _list[i]["link"] + '">';
                switch (me.sets.type) {
                case 'alsolike':
                    html += '<img width="128" height="128" alt="' + _list[i]["title"] + '" src="' + _list[i]["image"] + '">';
                    html += '<img width="128" height="128" class="imageHover" src="' + litb.resouceURL + 'base-images/imageHover128.png">';
                    if (_list[i]["discount"] != 0) {
                        html += '<em class="iconDiscount">' + _list[i]["discount"] + '</em>'
                    }
                    html += '</a></dt>';
                    html += '<dd><a ' + _ctr + ' class="ctrTrack" entity="p_name" alt="' + _list[i]["title"] + '" title="' + _list[i]["title"] + '" href="' + _list[i]["link"] + '">' + _list[i]["name"] + '</a></dd>';
                    html += '<dd><span class="oldPrice">' + _list[i]["listPrice"] + '</span><a ' + _ctr + ' class="ctrTrack price" entity="p_price" title="' + _list[i]["title"] + '" href="' + _list[i]["link"] + '" rel="nofollow">' + _list[i]["price"] + '</a></dd>';
                    break;
                case 'recenthistory':
                    html += '<img width="128" height="128" alt="' + _list[i]["title"] + '" src="' + _list[i]["image"] + '">';
                    html += '<img width="128" height="128" class="imageHover" src="' + litb.resouceURL + 'base-images/imageHover128.png">';
                    html += '</a></dt><dd><p><a ' + _ctr + ' class="ctrTrack" entity="p_name" alt="' + _list[i]["title"] + '" title="' + _list[i]["title"] + '" href="' + _list[i]["link"] + '">' + _list[i]["name"] + '</a></p>';
                    html += '</dd>';
                    break;
                case 'ultimatelybuy':
                    html += '<img width="128" height="128" alt="' + _list[i]["title"] + '" src="' + _list[i]["image"] + '">';
                    html += '<img width="128" height="128" class="imageHover" src="' + litb.resouceURL + 'base-images/imageHover128.png">';
                    if (_list[i]["discount"] != 0) {
                        html += '<em class="iconDiscount">' + _list[i]["discount"] + '</em>'
                    }
                    html += '</a></dt>';
                    html += '<dd class="title"><a ' + _ctr + ' class="ctrTrack" entity="p_name" title="' + _list[i]["title"] + '" href="' + _list[i]["link"] + '">' + _list[i]["name"] + '</a></dd>';
                    if (litb.langs.bought == '') {
                        html += '<dd class="bought-info"><div class="progress progress-info"><div style="width: ' + _list[i]["salepercent"] + '%" class="bar"></div><div class="bought">' + litb.langs.bought + ' ' + _list[i]["salepercent"] + '%' + '</div></div></dd>';
                        html += '<dd class="buy">' + litb.langs.bought + ' ' + _list[i]["salepercent"] + '%' + '</dd>'
                    } else {
                        html += '<dd class="bought-info"><div class="progress progress-info"><div style="width: ' + _list[i]["salepercent"] + '%" class="bar"></div><div class="bought">' + _list[i]["salepercent"] + '% ' + litb.langs.bought + '</div></div></dd>';
                        html += '<dd class="buy">' + _list[i]["salepercent"] + '% ' + litb.langs.bought + '</dd>'
                    }
                    html += '<dd><span class="oldPrice">' + _list[i]["listPrice"] + '</span><a ' + _ctr + ' class="ctrTrack price" entity="p_price" title="' + _list[i]["title"] + '" href="' + _list[i]["link"] + '" rel="nofollow">' + _list[i]["price"] + '</a></dd>';
                    break;
                case 'boughttogether':
                    html += '<img width="128" height="128" alt="' + _list[i]["title"] + '" src="' + _list[i]["image"] + '">';
                    html += '<img width="128" height="128" class="imageHover" src="' + litb.resouceURL + 'base-images/imageHover128.png">';
                    html += '</a></dt>';
                    html += '<dd class="title"><a entity="p_name" ' + _ctr + ' class="ctrTrack" alt="' + _list[i]["title"] + '" title="' + _list[i]["title"] + '" href="' + _list[i]["link"] + '">' + _list[i]["name"] + '</a></dd>';
                    html += '<dd class="price del">' + _list[i]["price"] + '</dd>';
                    html += '<dd><em class="textFreeShipping">' + litb.langs.free + '</em></dd>';
                    break
                };
                html += '</dl>'
            }
            $me.find(".w-productList").html(html)
        });
        if (me.sets.tra > 0 || me.sets.type == 'recenthistory') bindCtr($me.find(".w-productList"))
    };
    this.setPage = function(n) {
        var _n = Math.ceil(me.sets.data.length / me.sets.show) - 1;
        me.sets.now += n;
        $(".arrRight", $me).show();
        $(".arrLeft", $me).show();
        if (me.sets.now <= 0) {
            $(".arrLeft", $me).hide()
        } else if (me.sets.now >= (_n)) {
            $(".arrRight", $me).hide()
        }
        this.set();
        me.showPage();
        if (me.sets.data.length <= me.sets.show) {
            $(".arrRight", $me).hide();
            $(".arrRight", $me).hide()
        }
    };
    this.showPage = function() {
        $me.find(".page").html('page ' + (me.sets.now + 1) + ' of ' + Math.ceil(me.sets.data.length / me.sets.show))
    };
    $me.find(".arrLeft").focus(function() {
        $(this).blur()
    }).click(function() {
        me.setPage( - 1);
        me.sets.tra++
    });
    $me.find(".arrRight").focus(function() {
        $(this).blur()
    }).click(function() {
        me.setPage(1);
        me.sets.tra++
    });
    me.setPage(0)
};
$.fn.autocompleteEmail = function(options) {
    var me = this,
    $input = $(this);
    var defaults = {
        resultsClass: "mailInstant",
        resultsid: "resultsEmail",
        overClass: "over",
        minChars: 1,
        zIndex: 9992,
        width: 2,
        delay: 50,
        esc: false,
        data: []
    };
    var options = $.extend(defaults, options);
    var timeout = null;
    var active = -1;
    var hasFocus = false;
    var prev = "";
    litb.emailList = '';
    var lastKeyPressCode = null;
    var _url = litb.baseURL + 'index.php?main_page=info_check&action=get_email_domains&language=' + litb['lan'];
    this.init = function() {
        var results = document.createElement("div");
        var $results = $(results);
        $results.css("z-index", options.zIndex);
        $results.attr("id", options.resultsid);
        $results.hide().addClass(options.resultsClass).css("position", "absolute");
        if (!$('#' + options.resultsid)[0]) $("body").prepend(results)
    };
    $(document).ready(function() {
        if (litb.emailList == '') {
            $.ajax({
                type: 'post',
                url: _url,
                success: function(data) {
                    data = eval('[' + data + ']')[0];
                    if (data != '') {
                        litb.emailList = data
                    }
                }
            })
        }
    });
    function hidePP(e) {
        var unicode = e.keyCode ? e.keyCode: e.charCode;
        if (unicode == 27) {
            $('#' + options.resultsid).hide();
            options.esc = true;
            $(document).unbind('keydown', hidePP)
        }
    };
    $(document).keydown(hidePP);
    this.showResult = function() {
        if (!$input.val()) return;
        me.requestData()
    };
    this.showHtml = function(data, _len, _val, __val, ul) {
        for (var i = 0; i < data.length; i++) {
            var li = document.createElement("li");
            li.innerHTML = '<span>' + __val + '</span>@' + data[i];
            ul.appendChild(li);
            if (_len != -1 && data[i].indexOf(_val) != 0) {
                $(li).remove()
            } else {
                $(li).show()
            }
        }
        $('h4', ul).after('<li>' + $input.val() + '</li>');
        $('li', ul).each(function(n) {
            if (n > 11) {
                $(this).remove()
            } else if (n > 0 && $(this).text() == $input.val()) {
                $(this).remove()
            } else {
                $(this).hover(function() {
                    $(this).addClass(options.overClass);
                    active = n
                },
                function() {
                    $(this).removeClass(options.overClass)
                }).click(function(e) {
                    me.selectItem(this);
                    e.preventDefault();
                    e.stopPropagation()
                })
            }
            $(this).attr({
                title: $(this).text(),
                alt: $(this).text()
            })
        });
        $("#" + options.resultsid).css({
            top: ($input.offset().top + $input.outerHeight() - 1) + "px",
            left: $input.offset().left + "px",
            width: $input.width() + options.width
        }).html(ul).show()
    };
    this.requestData = function() {
        var ul = document.createElement("ul");
        var _title = document.createElement("h4");
        $(_title).html(litb.langs.selecteMailType);
        ul.appendChild(_title);
        var _val = $input.val(),
        __val = $input.val();
        var _len = _val.indexOf('@');
        if (_len != -1) {
            _val = _val.substring(_len + 1, _val.length);
            __val = $input.val().substring(0, _len)
        }
        if (litb.emailList == '') {
            $.ajax({
                type: 'post',
                url: _url,
                data: '',
                complete: function() {},
                success: function(data) {
                    data = eval('[' + data + ']')[0];
                    if (data != '') {
                        me.showHtml(data, _len, _val, __val, ul);
                        litb.emailList = data
                    }
                },
                error: function() {}
            })
        } else {
            me.showHtml(litb.emailList, _len, _val, __val, ul)
        }
    };
    this.selectItem = function(li) {
        var v = $.trim($(li).text());
        $input.val(v);
        me.hideResultsNow()
    };
    this.hideResultsNow = function() {
        if (timeout) clearTimeout(timeout);
        timeout = setTimeout(function() {
            if ($("#" + options.resultsid).is(":visible")) {
                $("#" + options.resultsid).hide()
            }
        },
        200)
    };
    this.onChange = function() {
        if ((lastKeyPressCode >= 33 && lastKeyPressCode <= 45) || lastKeyPressCode == 144 || lastKeyPressCode == 145 || lastKeyPressCode == 9 || (lastKeyPressCode >= 112 && lastKeyPressCode <= 135)) return;
        var v = $input.val();
        if (v.length >= options.minChars && !options.esc) {
            me.showResult()
        } else {
            $("#" + options.resultsid).hide()
        };
        options.esc = false
    };
    this.moveSelect = function(step) {
        var lis = $("li", $("#" + options.resultsid));
        active += step;
        if (active < 0) {
            active = lis.size() - 1
        } else if (active >= lis.size()) {
            active = 0
        };
        $(lis).removeClass(options.overClass);
        $(lis).eq(active).addClass(options.overClass);
        $input.val($(lis).eq(active).text())
    };
    $input.keyup(function(e) {
        if (lastKeyPressCode == 13) return;
        hasFocus = true;
        lastKeyPressCode = e.keyCode;
        if (lastKeyPressCode < 37 || lastKeyPressCode > 40) {
            active = -1;
            if (timeout) clearTimeout(timeout);
            timeout = setTimeout(function() {
                me.onChange()
            },
            options.delay)
        }
    }).keydown(function(e) {
        hasFocus = true;
        lastKeyPressCode = e.keyCode;
        switch (e.keyCode) {
        case 13:
            if ($input.val() == "") {};
            me.hideResultsNow();
            if ($('#resultsEmail')[0].style.display == "block") {
                e.keyCode = 0;
                return false
            }
            break;
        case 38:
            e.preventDefault();
            if ($("#" + options.resultsid).is(":visible")) me.moveSelect( - 1);
            break;
        case 40:
            e.preventDefault();
            if ($("#" + options.resultsid).is(":visible")) me.moveSelect(1);
            break;
        default:
            break
        }
    }).blur(function() {
        hasFocus = false;
        me.hideResultsNow()
    });
    this.init()
};
$.fn.autocompleteCountry = function(options) {
    if (!$(this)[0]) return;
    var me = this,
    $this = $(this),
    $input = $('ul input', this);
    var defaults = {
        data: {},
        tecoData: {}
    };
    var options = $.extend(defaults, options);
    var active = -1;
    var hasFocus = false;
    var html = '';
    var timeout = null;
    var lastKeyPressCode = null;
    this.getSub = function(obj) {
        var _s = obj.text().substr(0, 15);
        if (obj.text().length > 16) _s = _s + '...';
        var _em = '<em class="' + obj.find('em').attr('class') + '"></em>' + _s + '</a><span class="caret"></span>';
        return _em
    };
    this.getCurrency = function() {
        return $('.yourCurrency em', $this).attr('class').replace(/flag /, '').replace(/flag /, '')
    };
    this.requestData = function() {
        for (var i in options.tecoData) {
            html += '<li><a ctr="{\'change_to_country\':\'' + i + '\'}" href=""><em class="flag ' + i + '"></em>' + options.tecoData[i] + '</a></li>'
        }
        html += '<li class="divider"></li>';
        for (var i in options.data) {
            html += '<li><a ctr="{\'change_to_country\':\'' + i + '\'}" href=""><em class="flag ' + i + '"></em>' + options.data[i] + '</a></li>'
        }
        $('.dropdown-menu ul', $this).html(html);
        $('.dropdown-menu ul a', $this).unbind('mousedown').bind('mousedown',
        function() {
            trackingClickDom($(this))
        });
        $('.dropdown-menu ul li a', $this).click(function() {
            if (!$(this).parent().hasClass('noResul')) {
                $('.yourCurrency').html(me.getSub($(this)));
                hasFocus = false;
                var _cut = me.getCurrency();
                litb['ctr']['country'] = _cut;
                $.ajax({
                    type: 'post',
                    url: litb.baseURL + 'index.php?main_page=info_check&action=change_country&country_code=' + _cut,
                    data: '',
                    complete: function() {},
                    success: function(data) {
                        if (data != '' && data == 1) {
                            if ($('body').attr('id') == 'productinfoBody') getProductFba()
                        }
                    },
                    error: function() {}
                });
                me.clearMenus();
                $this.removeClass('open');
                litb['cutSel'] = _cut;
                return false
            }
        }).hover(function() {
            $('.dropdown-menu ul li', $this).removeClass('over');
            active = $('.dropdown-menu ul li', $this).index(this)
        },
        function() {});
        html = ''
    };
    $(this).hover(function() {
        hasFocus = true
    },
    function() {
        hasFocus = false
    });
    $(document).click(function() {});
    $('.dropdown-toggle').click(function() {
        me.clearMenus()
    });
    this.clearMenus = function() {
        if (!hasFocus) {
            if ($(this).hasClass('open')) {
                me.requestData()
            }
            $input.val('');
            hasFocus = false
        }
    };
    this.showResult = function() {
        if ($input.val() == '') {
            me.requestData();
            return
        };
        me.requestData();
        var t = 0;
        $('.dropdown-menu ul li', $this).each(function(n) {
            if ($(this).text().toLowerCase().indexOf($input.val().toLowerCase()) == 0) {
                t++
            } else if ($(this).hasClass('divider')) {} else {
                $(this).remove()
            }
            if (n == 20 && t == 0) {
                $(this).remove()
            }
        });
        if (t == 0) {
            $('.dropdown-menu ul', $this).html('<li class="noResul">' + litb.langs["noResultMatch"] + '"' + $input.val() + '"</li>')
        }
    };
    this.onChange = function() {
        if ((lastKeyPressCode >= 33 && lastKeyPressCode <= 45) || lastKeyPressCode == 144 || lastKeyPressCode == 145 || lastKeyPressCode == 9 || (lastKeyPressCode >= 112 && lastKeyPressCode <= 135)) return;
        me.showResult()
    };
    this.moveSelect = function(step) {
        var lis = $('.dropdown-menu ul li', $this);
        active += step;
        if (active < 0) {
            active = lis.size() - 1
        } else if (active >= lis.size()) {
            active = 0
        };
        if (!$(lis).hasClass('noResul')) {
            $(lis).find('a').removeClass('over');
            $(lis).find('a').eq(active).addClass('over');
            $input.val($(lis).eq(active).text())
        }
    };
    this.init = function() {
        litb['cutSel'] = me.getCurrency();
        me.requestData()
    };
    $input.keyup(function(e) {
        hasFocus = true;
        lastKeyPressCode = e.keyCode;
        if (lastKeyPressCode < 37 || lastKeyPressCode > 40) {
            active = -1;
            if (timeout) clearTimeout(timeout);
            timeout = setTimeout(function() {
                me.onChange()
            },
            options.delay)
        }
    }).keydown(function(e) {
        lastKeyPressCode = e.keyCode;
        switch (e.keyCode) {
        case 13:
            if ($input.val() != '') {
                $('.dropdown-menu ul li', $this).each(function(n) {
                    if ($(this).text() != '' && $(this).text() == $input.val()) {
                        $('.yourCurrency').html(me.getSub($(this)));
                        hasFocus = false;
                        me.clearMenus();
                        $this.removeClass('open');
                        litb['cutSel'] = me.getCurrency();
                        return
                    }
                })
            }
            break;
        case 38:
            e.preventDefault();
            me.moveSelect( - 1);
            break;
        case 40:
            e.preventDefault();
            me.moveSelect(1);
            break;
        default:
            break
        }
    });
    me.init()
};
$.fn.setCurSelector = function(options) {
    if (!$(this)[0]) return;
    var me = this,
    $this = $(this);
    var defaults = {
        data: {},
        now: ''
    };
    me.options = $.extend(defaults, options);
    this.requestData = function() {
        var html = '',
        _html = '';
        if (litb['CountryCurrency'][litb['cutSel']]) {
            html += '<li class="sel_' + litb['CountryCurrency'][litb['cutSel']] + '"><a rel="nofollow" ctr="{\'change_to_currency\':\'' + i + '\'}" href="' + litb['CurrencyURLList'][litb['CountryCurrency'][litb['cutSel']]] + '"><em>' + litb["CurrencyList"][litb['CountryCurrency'][litb['cutSel']]] + '</em>' + litb['CountryCurrency'][litb['cutSel']] + '</a></li>';
            _html += '<li class="sel_' + litb['CountryCurrency'][litb['cutSel']] + '"><a rel="nofollow" ctr="{\'change_to_currency\':\'' + i + '\'}" href="' + litb['CurrencyURLList'][litb['CountryCurrency'][litb['cutSel']]] + '">' + litb['CountryCurrency'][litb['cutSel']] + '</a></li>'
        }
        for (var i in litb["CurrencyList"]) {
            if (i != litb['CountryCurrency'][litb['cutSel']]) {
                html += '<li class="sel_' + i + '"><a rel="nofollow" ctr="{\'change_to_currency\':\'' + i + '\'}" href="' + litb['CurrencyURLList'][i] + '"><em>' + litb["CurrencyList"][i] + '</em>' + i + '</a></li>';
                _html += '<li class="sel_' + i + '"><a rel="nofollow" ctr="{\'change_to_currency\':\'' + i + '\'}" href="' + litb['CurrencyURLList'][i] + '">' + i + '</a></li>'
            }
        }
        me.options.now = litb['cutSel'];
        return {
            'html': html,
            '_html': _html
        }
    };
    this.init = function() {
        me.setHtml()
    };
    this.setHtml = function() {
        if (me.options.now == litb['cutSel']) return;
        var data = me.requestData();
        $('.dropdown-menu', this).html(data['html']);
        $('.dropdown-menu a', this).unbind('mousedown').bind('mousedown',
        function() {
            trackingClickDom($(this))
        });
        if ($('body').attr('id') == 'productinfoBody') {
            $('.currentPrice dd ul').html(data['_html'])
        }
    };
    $('.dropdown-toggle', $this).click(function() {
        me.setHtml()
    });
    this.init()
};
$.fn.topButtonToggle = function(options) {
    var me = this,
    $this = $(this);
    var defaults = {
        show: ''
    };
    me.options = $.extend(defaults, options);
    $('.btn-group', me).each(function(n) {
        $('.dropdown-toggle', this).click(function() {
            $(this).parent().toggleClass('open')
        });
        $(this).hover(function() {
            me.options.show = $(this).attr('id')
        },
        function() {
            me.options.show = ''
        })
    });
    $(document).click(function() {
        $('.btn-group', me).each(function() {
            if ($(this).attr('id') != me.options.show) {
                $(this).removeClass('open')
            }
        })
    })
};
function loadJS(url, success, id) {
    if (document.getElementById(id)) return;
    var _script = document.createElement('script');
    _script.src = url;
    _script.id = id;
    success = success ||
    function() {};
    _script.onload = _script.onreadystatechange = function() {
        if (!this.readyState || 'loaded' === this.readyState || 'complete' === this.readyState) {
            success(success, id);
            this.onload = this.onreadystatechange = null
        }
    };
    document.getElementsByTagName('head')[0].appendChild(_script)
};
$(function() {
    if ($('.new-wechat').size() !== 0) {
        var tpl = litb.baseURL.search('lightinthebox') >= 0 ? mainbox: minibox;
        $('.mini-wechat').tooltip({
            position: 'vertical',
            locate: 'center',
            hoverHide: 1,
            html: tpl,
            width: 215,
            forceTop: true
        }); (function() {
            var enteredTooltip = false;
            $('.mini-wechat').mouseleave(function() {
                setTimeout(function() { ! enteredTooltip && $('#tooltip').hide()
                },
                50)
            });
            $('#tooltip').live('mouseover',
            function() {
                enteredTooltip = true
            });
            $('#tooltip').live('mouseout',
            function() {
                enteredTooltip = false
            })
        })()
    }
}); !
function($) {
    "use strict";
    var Tab = function(element) {
        this.element = $(element)
    };
    Tab.prototype = {
        constructor: Tab,
        show: function() {
            var $this = this.element,
            $ul = $this.closest('ul:not(.dropdown-menu)'),
            selector = $this.attr('data-target'),
            previous,
            $target;
            if (!selector) {
                selector = $this.attr('href');
                selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '')
            }
            if ($this.parent('li').hasClass('active')) return;
            previous = $ul.find('.active a')[0];
            $this.trigger({
                type: 'show',
                relatedTarget: previous
            });
            $target = $(selector);
            this.activate($this.parent('li'), $ul);
            this.activate($target, $target.parent(),
            function() {
                $this.trigger({
                    type: 'shown',
                    relatedTarget: previous
                })
            })
        },
        activate: function(element, container, callback) {
            var $active = container.find('> .active'),
            transition = callback && $.support.transition && $active.hasClass('fade');
            function next() {
                $active.removeClass('active').find('> .dropdown-menu > .active').removeClass('active');
                element.addClass('active');
                if (transition) {
                    element[0].offsetWidth;
                    element.addClass('in')
                } else {
                    element.removeClass('fade')
                }
                if (element.parent('.dropdown-menu')) {
                    element.closest('li.dropdown').addClass('active')
                }
                callback && callback()
            }
            transition ? $active.one($.support.transition.end, next) : next();
            $active.removeClass('in')
        }
    };
    $.fn.tab = function(option) {
        return this.each(function() {
            var $this = $(this),
            data = $this.data('tab');
            if (!data) $this.data('tab', (data = new Tab(this)));
            if (typeof option == 'string') data[option]()
        })
    };
    $.fn.tab.Constructor = Tab;
    $(function() {
        $('body').find('[data-toggle="tab"], [data-toggle="pill"]').click(function(e) {
            e.preventDefault();
            $(this).tab('show')
        })
    })
} (window.jQuery); !
function($) {
    "use strict";
    var toggle = '[data-toggle="dropdown"]',
    Dropdown = function(element) {
        var $el = $(element).click(this.toggle);
        $('html').click(function() {
            $el.parent().removeClass('open')
        })
    };
    Dropdown.prototype = {
        constructor: Dropdown,
        toggle: function(e) {
            var $this = $(this),
            $parent,
            selector,
            isActive;
            if ($this.is('.disabled, :disabled')) return;
            selector = $this.attr('data-target');
            if (!selector) {
                selector = $this.attr('href');
                selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '')
            }
            if (!selector || typeof selector == 'undefined') {
                $parent = $(this).parent()
            } else {
                $parent = $(selector);
                $parent.length || ($parent = $this.parent())
            }
            isActive = $parent.hasClass('open');
            clearMenus();
            if (!isActive) $parent.toggleClass('open');
            return false
        }
    };
    function clearMenus() {
        $(toggle).parent().removeClass('open')
    };
    $.fn.dropdown = function(option) {
        return this.each(function() {
            var $this = $(this),
            data = $this.data('dropdown');
            if (!data) $this.data('dropdown', (data = new Dropdown(this)));
            if (typeof option == 'string') data[option].call($this)
        })
    };
    $.fn.dropdown.Constructor = Dropdown;
    $(function() {
        $('html').click(clearMenus);
        $('.dropdown form').click(function(e) {
            e.stopPropagation()
        });
        $(toggle).click(Dropdown.prototype.toggle)
    })
} (window.jQuery);


/**/
// $('#addressEditForm').submit(function() {
//     $(this).siblings('.error').hide();
//     $('input, button', this).blur();
//     $('#addressEditForm .errorTip').html('');
//         var _minlength = (litb.lan=='ja'||litb.lan=='ko')?2:3;
//     var items = {
//         firstname : [{type:'null', errMsg:litb.langs.poAddr.noFirstName}, {type:'latinMinlength', minlength:2, errMsg:litb.langs.poAddr.shortFirstName.stringFormat(2)}],
//         lastname : [{type:'null', errMsg:litb.langs.poAddr.noLastName}, {type:'latinMinlength', minlength:2, errMsg:litb.langs.poAddr.shortLastName.stringFormat(2)}, {type:'fullname', latinMaxlength:34, jpMaxlength:11, errMsg:litb.langs.poAddr.exceedFullName}],
//         street_address : [{type:'null', errMsg:litb.langs.poAddr.noShippingAddress}, {type:'minlength', minlength:5, errMsg:litb.langs.poAddr.shortShippingAddress.stringFormat(5)}],
//         city : [{type:'null', errMsg:litb.langs.poAddr.noCity}, {type:'minlength', minlength:_minlength, errMsg:litb.langs.poAddr.shortCity.stringFormat(_minlength)}],
//         country_id : [{type:'select', value:-1, errMsg:litb.langs.poAddr.noCountry}],
//         zone_id : [{type:'select', value:-1, errMsg:litb.langs.poAddr.noZoneId}],
//         tax_code_value : [{type:'nullPersonal', errMsg:litb.langs.poAddr.noPersonalTaxCode}, {type:'nullCompany', errMsg:litb.langs.poAddr.noCompanyTaxCode}, {type:'personalTaxCode', minlength:11, errMsg:litb.langs.poAddr.invalidPersonalTaxCode.stringFormat(11)}, {type:'companyTaxCode', minlength:14, errMsg:litb.langs.poAddr.invalidCompanyTaxCode.stringFormat(14)}],
//         postcode : [{type:'null', errMsg:litb.langs.poAddr.noPostcode}, {type:'minlength', minlength:4, errMsg:litb.langs.poAddr.shortPostcode.stringFormat(4)}],
//         phone : [{type:'null', errMsg:litb.langs.poAddr.noPhone}, {type:'digitMinlength', minlength:7, errMsg:litb.langs.poAddr.shortPhone.stringFormat(7)}, {type:'phone', maxlength:15, errMsg:litb.langs.poAddr.invalidPhone}, {type:'areaPhone', maxlength:15, errMsg:litb.langs.poAddr.areaPhoneExceed.stringFormat(15)}]
//     };
    
//     return $('#addressEditForm').formCheck(items, {
//         errinfoFinder: function(obj) {return obj.siblings(':last');},
//         rules: {latinMinlength : function(obj, checks) {if (litb.lan=='ja'||litb.lan=='ko')return true; return $(obj).val().length >= checks.minlength;},
//             fullname : function(obj, checks) {var maxlength = (litb.lan=='ja'||litb.lan=='ko')?checks.jpMaxlength:checks.latinMaxlength;return $('#firstname').val().length + $('#lastname').val().length <= maxlength;},
//             nullPersonal : function(obj, checks) {if ($('#taxCodeOption').val() == '1') {return $(obj).val().length > 0;} return true;},
//             nullCompany  : function(obj, checks) {if ($('#taxCodeOption').val() == '2') {return $(obj).val().length > 0;} return true;},
//             personalTaxCode : function(obj, checks) {if ($('#taxCodeOption').val() == '1') {return $(obj).val().replace(/[\.\-/]/g, '').length >= checks.minlength && $(obj).val().replace(/[0-9\.\-/]/g, '').length == 0;} return true;},
//             companyTaxCode : function(obj, checks) {if ($('#taxCodeOption').val() == '2') {return $(obj).val().replace(/[\.\-/]/g, '').length >= checks.minlength && $(obj).val().replace(/[0-9\.\-/]/g, '').length == 0;} return true;},
//             areaPhone : function(obj, checks) {return ($(obj).prev().val().replace('+','').length + $.trim($(obj).val().replace(/[\s]+/g, ' ')).length <= checks.maxlength);}}
//     });
// });
